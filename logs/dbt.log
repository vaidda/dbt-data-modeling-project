[0m12:47:03.556265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4a1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107edee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107edbb0>]}


============================== 12:47:03.567187 | cf61d8d8-5f0b-4465-8b33-2a07e8896a40 ==============================
[0m12:47:03.567187 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:47:03.569039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/Users/vaida/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt init dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:03.608666 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse logging event dictionary. Failed to parse dir field: expected string or bytes-like object.. Dictionary: {'dir': PosixPath('/Users/vaida/.dbt')}
[0m12:47:03.609545 [info ] [MainThread]: Creating dbt configuration folder at 
[0m12:47:53.971319 [debug] [MainThread]: Starter project path: /Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/include/starter_project
[0m12:47:53.992268 [info ] [MainThread]: 
Your new dbt project "dbt_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m12:47:53.993498 [info ] [MainThread]: Setting up your profile.
[0m12:49:14.246281 [info ] [MainThread]: Profile dbt_project written to /Users/vaida/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m12:49:14.263233 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 130.87263, "process_in_blocks": "0", "process_kernel_time": 0.676764, "process_mem_max_rss": "89436160", "process_out_blocks": "0", "process_user_time": 3.306066}
[0m12:49:14.264753 [debug] [MainThread]: Command `dbt init` succeeded at 12:49:14.264404 after 130.87 seconds
[0m12:49:14.266084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4a1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11084dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e4640>]}
[0m12:49:14.267710 [debug] [MainThread]: Flushing usage events
[0m12:49:14.813330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:35.063764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bff5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bff58e0>]}


============================== 12:49:35.074791 | ea0f7804-b86b-4ab5-8a02-c821aadbc3af ==============================
[0m12:49:35.074791 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:49:35.076323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/vaida/.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:49:35.136031 [info ] [MainThread]: dbt version: 1.9.3
[0m12:49:35.137121 [info ] [MainThread]: python version: 3.9.6
[0m12:49:35.137933 [info ] [MainThread]: python path: /Users/vaida/Playground/crypto_dbt_project/venv/bin/python3
[0m12:49:35.138722 [info ] [MainThread]: os info: macOS-14.7.4-x86_64-i386-64bit
[0m12:49:35.287217 [info ] [MainThread]: Using profiles dir at /Users/vaida/.dbt
[0m12:49:35.287930 [info ] [MainThread]: Using profiles.yml file at /Users/vaida/.dbt/profiles.yml
[0m12:49:35.288727 [info ] [MainThread]: Using dbt_project.yml file at /Users/vaida/Playground/crypto_dbt_project/dbt_project.yml
[0m12:49:35.290339 [info ] [MainThread]: adapter type: postgres
[0m12:49:35.291286 [info ] [MainThread]: adapter version: 1.9.0
[0m12:49:35.292106 [info ] [MainThread]: Configuration:
[0m12:49:35.292650 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:49:35.293340 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:49:35.293987 [info ] [MainThread]: Required dependencies:
[0m12:49:35.295281 [debug] [MainThread]: Executing "git --help"
[0m12:49:35.347226 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:49:35.348947 [debug] [MainThread]: STDERR: "b''"
[0m12:49:35.349804 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:49:35.350547 [info ] [MainThread]: Connection:
[0m12:49:35.351296 [info ] [MainThread]:   host: localhost
[0m12:49:35.352444 [info ] [MainThread]:   port: 5432
[0m12:49:35.353037 [info ] [MainThread]:   user: postgres
[0m12:49:35.353623 [info ] [MainThread]:   database: postgres
[0m12:49:35.354200 [info ] [MainThread]:   schema: public
[0m12:49:35.354778 [info ] [MainThread]:   connect_timeout: 10
[0m12:49:35.355491 [info ] [MainThread]:   role: None
[0m12:49:35.356090 [info ] [MainThread]:   search_path: None
[0m12:49:35.356657 [info ] [MainThread]:   keepalives_idle: 0
[0m12:49:35.357216 [info ] [MainThread]:   sslmode: None
[0m12:49:35.357767 [info ] [MainThread]:   sslcert: None
[0m12:49:35.358328 [info ] [MainThread]:   sslkey: None
[0m12:49:35.358862 [info ] [MainThread]:   sslrootcert: None
[0m12:49:35.359394 [info ] [MainThread]:   application_name: dbt
[0m12:49:35.359928 [info ] [MainThread]:   retries: 1
[0m12:49:35.361054 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:49:35.584801 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:49:35.769601 [debug] [MainThread]: Using postgres connection "debug"
[0m12:49:35.771242 [debug] [MainThread]: On debug: select 1 as id
[0m12:49:35.772403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:35.872831 [debug] [MainThread]: SQL status: SELECT 1 in 0.100 seconds
[0m12:49:35.875294 [debug] [MainThread]: On debug: Close
[0m12:49:35.876267 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:49:35.877276 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:49:35.878090 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/vaida/Playground/crypto_dbt_project/dbt_project.yml> not found

[0m12:49:35.882077 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.9417758, "process_in_blocks": "0", "process_kernel_time": 0.78877, "process_mem_max_rss": "99733504", "process_out_blocks": "0", "process_user_time": 3.278218}
[0m12:49:35.885798 [debug] [MainThread]: Command `dbt debug` failed at 12:49:35.884219 after 0.95 seconds
[0m12:49:35.887702 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:49:35.889100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c57bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c57b5b0>]}
[0m12:49:35.890336 [debug] [MainThread]: Flushing usage events
[0m12:49:36.361087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:08.883357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba62a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cda4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cda4790>]}


============================== 12:50:08.893250 | f4208296-3a72-4c46-8fbb-2dea10eef833 ==============================
[0m12:50:08.893250 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:50:08.894596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:50:08.949208 [info ] [MainThread]: dbt version: 1.9.3
[0m12:50:08.950621 [info ] [MainThread]: python version: 3.9.6
[0m12:50:08.955722 [info ] [MainThread]: python path: /Users/vaida/Playground/crypto_dbt_project/venv/bin/python3
[0m12:50:08.956714 [info ] [MainThread]: os info: macOS-14.7.4-x86_64-i386-64bit
[0m12:50:09.179168 [info ] [MainThread]: Using profiles dir at /Users/vaida/.dbt
[0m12:50:09.179913 [info ] [MainThread]: Using profiles.yml file at /Users/vaida/.dbt/profiles.yml
[0m12:50:09.180422 [info ] [MainThread]: Using dbt_project.yml file at /Users/vaida/Playground/crypto_dbt_project/dbt_project.yml
[0m12:50:09.181866 [info ] [MainThread]: adapter type: postgres
[0m12:50:09.182644 [info ] [MainThread]: adapter version: 1.9.0
[0m12:50:09.356263 [info ] [MainThread]: Configuration:
[0m12:50:09.356954 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:50:09.357447 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:50:09.357921 [info ] [MainThread]: Required dependencies:
[0m12:50:09.358509 [debug] [MainThread]: Executing "git --help"
[0m12:50:09.425124 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:50:09.426911 [debug] [MainThread]: STDERR: "b''"
[0m12:50:09.427744 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:50:09.428547 [info ] [MainThread]: Connection:
[0m12:50:09.429414 [info ] [MainThread]:   host: localhost
[0m12:50:09.430137 [info ] [MainThread]:   port: 5432
[0m12:50:09.430827 [info ] [MainThread]:   user: postgres
[0m12:50:09.431515 [info ] [MainThread]:   database: postgres
[0m12:50:09.432194 [info ] [MainThread]:   schema: public
[0m12:50:09.432855 [info ] [MainThread]:   connect_timeout: 10
[0m12:50:09.433541 [info ] [MainThread]:   role: None
[0m12:50:09.434587 [info ] [MainThread]:   search_path: None
[0m12:50:09.436052 [info ] [MainThread]:   keepalives_idle: 0
[0m12:50:09.436814 [info ] [MainThread]:   sslmode: None
[0m12:50:09.437463 [info ] [MainThread]:   sslcert: None
[0m12:50:09.438091 [info ] [MainThread]:   sslkey: None
[0m12:50:09.438723 [info ] [MainThread]:   sslrootcert: None
[0m12:50:09.439352 [info ] [MainThread]:   application_name: dbt
[0m12:50:09.439981 [info ] [MainThread]:   retries: 1
[0m12:50:09.441338 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:50:09.711075 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:50:09.786712 [debug] [MainThread]: Using postgres connection "debug"
[0m12:50:09.787451 [debug] [MainThread]: On debug: select 1 as id
[0m12:50:09.787997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:09.858252 [debug] [MainThread]: SQL status: SELECT 1 in 0.070 seconds
[0m12:50:09.861813 [debug] [MainThread]: On debug: Close
[0m12:50:09.863331 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:50:09.864852 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:50:09.870977 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1203531, "process_in_blocks": "0", "process_kernel_time": 0.724609, "process_mem_max_rss": "101212160", "process_out_blocks": "0", "process_user_time": 3.365429}
[0m12:50:09.873200 [debug] [MainThread]: Command `dbt debug` succeeded at 12:50:09.872792 after 1.12 seconds
[0m12:50:09.874437 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:50:09.878312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba62a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1eab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd7a850>]}
[0m12:50:09.884212 [debug] [MainThread]: Flushing usage events
[0m12:50:10.360365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:27.787521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107194a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d8700>]}


============================== 12:57:27.802728 | 8bb2912b-3a08-4033-9fc5-0f66bc0ccc79 ==============================
[0m12:57:27.802728 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:57:27.804207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:27.870126 [info ] [MainThread]: dbt version: 1.9.3
[0m12:57:27.871250 [info ] [MainThread]: python version: 3.9.6
[0m12:57:27.872079 [info ] [MainThread]: python path: /Users/vaida/Playground/crypto_dbt_project/venv/bin/python3
[0m12:57:27.873186 [info ] [MainThread]: os info: macOS-14.7.4-x86_64-i386-64bit
[0m12:57:27.889933 [info ] [MainThread]: Using profiles dir at /Users/vaida/Playground/crypto_dbt_project/dbt
[0m12:57:27.894522 [info ] [MainThread]: Using profiles.yml file at /Users/vaida/Playground/crypto_dbt_project/dbt/profiles.yml
[0m12:57:27.896680 [info ] [MainThread]: Using dbt_project.yml file at /Users/vaida/Playground/crypto_dbt_project/dbt_project.yml
[0m12:57:28.122350 [info ] [MainThread]: Configuration:
[0m12:57:28.123063 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:57:28.123579 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:57:28.124070 [info ] [MainThread]: Required dependencies:
[0m12:57:28.124703 [debug] [MainThread]: Executing "git --help"
[0m12:57:28.206774 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:57:28.208680 [debug] [MainThread]: STDERR: "b''"
[0m12:57:28.210285 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:57:28.211081 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:57:28.211950 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:57:28.212741 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'dbt_project'


[0m12:57:28.217377 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.60279036, "process_in_blocks": "0", "process_kernel_time": 0.622647, "process_mem_max_rss": "89841664", "process_out_blocks": "0", "process_user_time": 3.225239}
[0m12:57:28.218646 [debug] [MainThread]: Command `dbt debug` failed at 12:57:28.218408 after 0.60 seconds
[0m12:57:28.219758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107194a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fa0a0>]}
[0m12:57:28.220796 [debug] [MainThread]: Flushing usage events
[0m12:57:28.717024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:16.451692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bf1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f38280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f385e0>]}


============================== 12:58:16.462629 | 7f2a7a96-314e-454d-afd5-d7fd5141d1b8 ==============================
[0m12:58:16.462629 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:58:16.464233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:58:16.520135 [info ] [MainThread]: dbt version: 1.9.3
[0m12:58:16.521235 [info ] [MainThread]: python version: 3.9.6
[0m12:58:16.525083 [info ] [MainThread]: python path: /Users/vaida/Playground/crypto_dbt_project/venv/bin/python3
[0m12:58:16.526120 [info ] [MainThread]: os info: macOS-14.7.4-x86_64-i386-64bit
[0m12:58:16.545107 [info ] [MainThread]: Using profiles dir at /Users/vaida/Playground/crypto_dbt_project/dbt
[0m12:58:16.548134 [info ] [MainThread]: Using profiles.yml file at /Users/vaida/Playground/crypto_dbt_project/dbt/profiles.yml
[0m12:58:16.553152 [info ] [MainThread]: Using dbt_project.yml file at /Users/vaida/Playground/crypto_dbt_project/dbt_project.yml
[0m12:58:16.797812 [info ] [MainThread]: Configuration:
[0m12:58:16.798569 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:58:16.799142 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:58:16.799647 [info ] [MainThread]: Required dependencies:
[0m12:58:16.800257 [debug] [MainThread]: Executing "git --help"
[0m12:58:16.865332 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:58:16.867229 [debug] [MainThread]: STDERR: "b''"
[0m12:58:16.868765 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:58:16.869911 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:58:16.870709 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:58:16.871418 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'dbt_project'


[0m12:58:16.875529 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.56200916, "process_in_blocks": "0", "process_kernel_time": 0.550603, "process_mem_max_rss": "89518080", "process_out_blocks": "0", "process_user_time": 3.290455}
[0m12:58:16.876753 [debug] [MainThread]: Command `dbt debug` failed at 12:58:16.876492 after 0.56 seconds
[0m12:58:16.877883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bf1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a8ddc0>]}
[0m12:58:16.878926 [debug] [MainThread]: Flushing usage events
[0m12:58:17.413370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:19.836523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112073a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ba2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ba610>]}


============================== 13:01:19.849308 | 6ab6ddcd-be99-45e4-a335-8b4566be69dc ==============================
[0m13:01:19.849308 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:01:19.850743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:01:19.906447 [info ] [MainThread]: dbt version: 1.9.3
[0m13:01:19.907537 [info ] [MainThread]: python version: 3.9.6
[0m13:01:19.913115 [info ] [MainThread]: python path: /Users/vaida/Playground/crypto_dbt_project/venv/bin/python3
[0m13:01:19.916712 [info ] [MainThread]: os info: macOS-14.7.4-x86_64-i386-64bit
[0m13:01:20.100644 [info ] [MainThread]: Using profiles dir at /Users/vaida/Playground/crypto_dbt_project/dbt
[0m13:01:20.101357 [info ] [MainThread]: Using profiles.yml file at /Users/vaida/Playground/crypto_dbt_project/dbt/profiles.yml
[0m13:01:20.101852 [info ] [MainThread]: Using dbt_project.yml file at /Users/vaida/Playground/crypto_dbt_project/dbt_project.yml
[0m13:01:20.103112 [info ] [MainThread]: adapter type: postgres
[0m13:01:20.104169 [info ] [MainThread]: adapter version: 1.9.0
[0m13:01:20.267229 [info ] [MainThread]: Configuration:
[0m13:01:20.267919 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:01:20.268418 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:01:20.268896 [info ] [MainThread]: Required dependencies:
[0m13:01:20.269484 [debug] [MainThread]: Executing "git --help"
[0m13:01:20.341541 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:01:20.343321 [debug] [MainThread]: STDERR: "b''"
[0m13:01:20.344137 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:01:20.344929 [info ] [MainThread]: Connection:
[0m13:01:20.345726 [info ] [MainThread]:   host: localhost
[0m13:01:20.346381 [info ] [MainThread]:   port: 5432
[0m13:01:20.347011 [info ] [MainThread]:   user: postgres
[0m13:01:20.347672 [info ] [MainThread]:   database: dbt_project
[0m13:01:20.348395 [info ] [MainThread]:   schema: public
[0m13:01:20.349030 [info ] [MainThread]:   connect_timeout: 10
[0m13:01:20.349647 [info ] [MainThread]:   role: None
[0m13:01:20.350256 [info ] [MainThread]:   search_path: None
[0m13:01:20.350987 [info ] [MainThread]:   keepalives_idle: 0
[0m13:01:20.353079 [info ] [MainThread]:   sslmode: None
[0m13:01:20.357329 [info ] [MainThread]:   sslcert: None
[0m13:01:20.358391 [info ] [MainThread]:   sslkey: None
[0m13:01:20.360474 [info ] [MainThread]:   sslrootcert: None
[0m13:01:20.365471 [info ] [MainThread]:   application_name: dbt
[0m13:01:20.366621 [info ] [MainThread]:   retries: 1
[0m13:01:20.368363 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:01:20.621839 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:01:20.715909 [debug] [MainThread]: Using postgres connection "debug"
[0m13:01:20.716785 [debug] [MainThread]: On debug: select 1 as id
[0m13:01:20.717415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:20.774390 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "dbt_project" does not exist

[0m13:01:20.782316 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m13:01:20.783156 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m13:01:20.784000 [debug] [MainThread]: On debug: No close available on handle
[0m13:01:20.784798 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:01:20.785566 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:01:20.786286 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "dbt_project" does not exist
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:01:20.790751 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.0713806, "process_in_blocks": "0", "process_kernel_time": 0.717339, "process_mem_max_rss": "101662720", "process_out_blocks": "0", "process_user_time": 3.066337}
[0m13:01:20.791953 [debug] [MainThread]: Command `dbt debug` failed at 13:01:20.791667 after 1.07 seconds
[0m13:01:20.792773 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:01:20.793595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112073a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11391e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113972040>]}
[0m13:01:20.794522 [debug] [MainThread]: Flushing usage events
[0m13:01:21.339019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:29.376543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109413ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7582b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a758610>]}


============================== 13:04:29.388927 | e0e27867-73fa-470a-8c2c-e3a6ef20bf89 ==============================
[0m13:04:29.388927 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:04:29.391090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:04:29.434399 [info ] [MainThread]: dbt version: 1.9.3
[0m13:04:29.436530 [info ] [MainThread]: python version: 3.9.6
[0m13:04:29.441796 [info ] [MainThread]: python path: /Users/vaida/Playground/crypto_dbt_project/venv/bin/python3
[0m13:04:29.442920 [info ] [MainThread]: os info: macOS-14.7.4-x86_64-i386-64bit
[0m13:04:29.642512 [info ] [MainThread]: Using profiles dir at /Users/vaida/Playground/crypto_dbt_project/dbt
[0m13:04:29.643292 [info ] [MainThread]: Using profiles.yml file at /Users/vaida/Playground/crypto_dbt_project/dbt/profiles.yml
[0m13:04:29.643898 [info ] [MainThread]: Using dbt_project.yml file at /Users/vaida/Playground/crypto_dbt_project/dbt_project.yml
[0m13:04:29.645046 [info ] [MainThread]: adapter type: postgres
[0m13:04:29.645704 [info ] [MainThread]: adapter version: 1.9.0
[0m13:04:29.850256 [info ] [MainThread]: Configuration:
[0m13:04:29.850979 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:04:29.851529 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:04:29.852039 [info ] [MainThread]: Required dependencies:
[0m13:04:29.852666 [debug] [MainThread]: Executing "git --help"
[0m13:04:29.921436 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:04:29.923011 [debug] [MainThread]: STDERR: "b''"
[0m13:04:29.923766 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:04:29.924428 [info ] [MainThread]: Connection:
[0m13:04:29.925140 [info ] [MainThread]:   host: localhost
[0m13:04:29.925705 [info ] [MainThread]:   port: 5432
[0m13:04:29.926249 [info ] [MainThread]:   user: postgres
[0m13:04:29.926792 [info ] [MainThread]:   database: crypto
[0m13:04:29.927338 [info ] [MainThread]:   schema: public
[0m13:04:29.927897 [info ] [MainThread]:   connect_timeout: 10
[0m13:04:29.928427 [info ] [MainThread]:   role: None
[0m13:04:29.929200 [info ] [MainThread]:   search_path: None
[0m13:04:29.930184 [info ] [MainThread]:   keepalives_idle: 0
[0m13:04:29.931099 [info ] [MainThread]:   sslmode: None
[0m13:04:29.932029 [info ] [MainThread]:   sslcert: None
[0m13:04:29.933036 [info ] [MainThread]:   sslkey: None
[0m13:04:29.935254 [info ] [MainThread]:   sslrootcert: None
[0m13:04:29.936205 [info ] [MainThread]:   application_name: dbt
[0m13:04:29.937185 [info ] [MainThread]:   retries: 1
[0m13:04:29.939896 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:04:30.174318 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:04:30.265061 [debug] [MainThread]: Using postgres connection "debug"
[0m13:04:30.265724 [debug] [MainThread]: On debug: select 1 as id
[0m13:04:30.266228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:30.324579 [debug] [MainThread]: SQL status: SELECT 1 in 0.058 seconds
[0m13:04:30.326465 [debug] [MainThread]: On debug: Close
[0m13:04:30.327337 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:04:30.328408 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:04:30.333265 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0894204, "process_in_blocks": "0", "process_kernel_time": 0.692058, "process_mem_max_rss": "101208064", "process_out_blocks": "0", "process_user_time": 3.242327}
[0m13:04:30.334708 [debug] [MainThread]: Command `dbt debug` succeeded at 13:04:30.334400 after 1.09 seconds
[0m13:04:30.335847 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:04:30.337086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109413ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abba880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba9100>]}
[0m13:04:30.339280 [debug] [MainThread]: Flushing usage events
[0m13:04:30.798214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:55.992946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103094a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d8b80>]}


============================== 13:05:56.002714 | 94e2d73a-aa4b-4ba7-beda-91f090c85f7c ==============================
[0m13:05:56.002714 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:05:56.004046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:05:56.335331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94e2d73a-aa4b-4ba7-beda-91f090c85f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c0a00>]}
[0m13:05:56.418358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94e2d73a-aa4b-4ba7-beda-91f090c85f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037f7340>]}
[0m13:05:56.420213 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:05:56.643232 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:05:56.644977 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:05:56.645796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94e2d73a-aa4b-4ba7-beda-91f090c85f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490d7f0>]}
[0m13:05:58.333522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.example
[0m13:05:58.341517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94e2d73a-aa4b-4ba7-beda-91f090c85f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ed130>]}
[0m13:05:58.441871 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m13:05:58.448060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m13:05:58.517177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94e2d73a-aa4b-4ba7-beda-91f090c85f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bf490>]}
[0m13:05:58.518600 [info ] [MainThread]: Found 433 macros
[0m13:05:58.519500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94e2d73a-aa4b-4ba7-beda-91f090c85f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048bfd60>]}
[0m13:05:58.521842 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:05:58.523109 [debug] [MainThread]: Command end result
[0m13:05:58.583142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m13:05:58.586160 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m13:05:58.592373 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m13:05:58.594951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7069507, "process_in_blocks": "0", "process_kernel_time": 0.748946, "process_mem_max_rss": "98816000", "process_out_blocks": "0", "process_user_time": 5.045096}
[0m13:05:58.595956 [debug] [MainThread]: Command `dbt run` succeeded at 13:05:58.595755 after 2.71 seconds
[0m13:05:58.596740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103094a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a26250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037f70a0>]}
[0m13:05:58.597510 [debug] [MainThread]: Flushing usage events
[0m13:05:59.101744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:13.408507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8e7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8e7970>]}


============================== 13:09:13.419518 | 746b0501-741f-4e04-bd30-547071349f71 ==============================
[0m13:09:13.419518 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:09:13.420812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:09:13.746866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '746b0501-741f-4e04-bd30-547071349f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109439ca0>]}
[0m13:09:13.852786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '746b0501-741f-4e04-bd30-547071349f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcb9880>]}
[0m13:09:13.854556 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:09:14.063431 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:09:14.135952 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:09:14.136668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '746b0501-741f-4e04-bd30-547071349f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad39430>]}
[0m13:09:15.603657 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.stg_crypto_prices' (dbt/models/staging/stg_crypto_prices.sql) depends on a source named 'public.raw_crypto_prices' which was not found
[0m13:09:15.607508 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3073547, "process_in_blocks": "0", "process_kernel_time": 0.647639, "process_mem_max_rss": "101019648", "process_out_blocks": "0", "process_user_time": 4.44908}
[0m13:09:15.608350 [debug] [MainThread]: Command `dbt run` failed at 13:09:15.608209 after 2.31 seconds
[0m13:09:15.608949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c775a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c775c40>]}
[0m13:09:15.609553 [debug] [MainThread]: Flushing usage events
[0m13:09:16.106024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:26.718257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109833a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab75f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab75be0>]}


============================== 13:11:26.728823 | 0183fb07-5ace-46ab-beaa-8c348134fc3b ==============================
[0m13:11:26.728823 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:11:26.730171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:27.076944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0183fb07-5ace-46ab-beaa-8c348134fc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af5e880>]}
[0m13:11:27.156416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0183fb07-5ace-46ab-beaa-8c348134fc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab06ee0>]}
[0m13:11:27.158684 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:11:27.393868 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:11:27.470293 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:11:27.471059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0183fb07-5ace-46ab-beaa-8c348134fc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd71f0>]}
[0m13:11:29.618956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0183fb07-5ace-46ab-beaa-8c348134fc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbe6130>]}
[0m13:11:29.764400 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m13:11:29.770184 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m13:11:29.818817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0183fb07-5ace-46ab-beaa-8c348134fc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bba9f70>]}
[0m13:11:29.819906 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m13:11:29.820683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0183fb07-5ace-46ab-beaa-8c348134fc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf1fa0>]}
[0m13:11:29.823327 [info ] [MainThread]: 
[0m13:11:29.824103 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:11:29.824770 [info ] [MainThread]: 
[0m13:11:29.825753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:29.827416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto'
[0m13:11:30.018682 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m13:11:30.020010 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m13:11:30.020901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:30.196103 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.175 seconds
[0m13:11:30.199344 [debug] [ThreadPool]: On list_crypto: Close
[0m13:11:30.202198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto, now create_crypto_public_staging)
[0m13:11:30.204710 [debug] [ThreadPool]: Creating schema "database: "crypto"
schema: "public_staging"
"
[0m13:11:30.226407 [debug] [ThreadPool]: Using postgres connection "create_crypto_public_staging"
[0m13:11:30.227928 [debug] [ThreadPool]: On create_crypto_public_staging: BEGIN
[0m13:11:30.229028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:30.255902 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m13:11:30.257178 [debug] [ThreadPool]: Using postgres connection "create_crypto_public_staging"
[0m13:11:30.258278 [debug] [ThreadPool]: On create_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_crypto_public_staging"} */
create schema if not exists "public_staging"
[0m13:11:30.294751 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.035 seconds
[0m13:11:30.297614 [debug] [ThreadPool]: On create_crypto_public_staging: COMMIT
[0m13:11:30.298714 [debug] [ThreadPool]: Using postgres connection "create_crypto_public_staging"
[0m13:11:30.300057 [debug] [ThreadPool]: On create_crypto_public_staging: COMMIT
[0m13:11:30.301903 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:11:30.303087 [debug] [ThreadPool]: On create_crypto_public_staging: Close
[0m13:11:30.305895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_public_staging, now list_crypto_public_staging)
[0m13:11:30.318999 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m13:11:30.319699 [debug] [ThreadPool]: On list_crypto_public_staging: BEGIN
[0m13:11:30.320231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:30.343823 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m13:11:30.344708 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m13:11:30.345449 [debug] [ThreadPool]: On list_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public_staging"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:11:30.402504 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.056 seconds
[0m13:11:30.407463 [debug] [ThreadPool]: On list_crypto_public_staging: ROLLBACK
[0m13:11:30.409631 [debug] [ThreadPool]: On list_crypto_public_staging: Close
[0m13:11:30.420144 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:30.421067 [debug] [MainThread]: On master: BEGIN
[0m13:11:30.421919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:30.446381 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m13:11:30.447563 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:30.448867 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:30.509830 [debug] [MainThread]: SQL status: SELECT 0 in 0.059 seconds
[0m13:11:30.512977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0183fb07-5ace-46ab-beaa-8c348134fc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc190d0>]}
[0m13:11:30.514081 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:30.537540 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:30.539114 [debug] [MainThread]: On master: BEGIN
[0m13:11:30.541644 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:11:30.543111 [debug] [MainThread]: On master: COMMIT
[0m13:11:30.544164 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:30.545124 [debug] [MainThread]: On master: COMMIT
[0m13:11:30.546423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:30.547520 [debug] [MainThread]: On master: Close
[0m13:11:30.562726 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m13:11:30.564177 [info ] [Thread-1  ]: 1 of 1 START sql view model public_staging.stg_crypto_prices ................... [RUN]
[0m13:11:30.565534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_crypto_public_staging, now model.dbt_project.stg_crypto_prices)
[0m13:11:30.566518 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m13:11:30.590210 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m13:11:30.593021 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m13:11:30.676121 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_crypto_prices"
[0m13:11:30.677832 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m13:11:30.678446 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: BEGIN
[0m13:11:30.679007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:11:30.692320 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m13:11:30.693229 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m13:11:30.694009 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */

  create view "crypto"."public_staging"."stg_crypto_prices__dbt_tmp"
    
    
  as (
    with source as (
    select * from "crypto"."public"."raw_crypto_prices"
),

renamed as (
    select
        coin_id,
        timestamp,
        price_usd
    from source
)

select * from renamed
  );
[0m13:11:30.705487 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:11:30.718399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m13:11:30.719226 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m13:11:30.737930 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.018 seconds
[0m13:11:30.769355 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m13:11:30.770178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m13:11:30.770835 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m13:11:30.789147 [debug] [Thread-1  ]: SQL status: COMMIT in 0.017 seconds
[0m13:11:30.806484 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public_staging"."stg_crypto_prices__dbt_backup"
[0m13:11:30.816557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m13:11:30.817440 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
drop view if exists "crypto"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m13:11:30.838235 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.019 seconds
[0m13:11:30.845456 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: Close
[0m13:11:30.850016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0183fb07-5ace-46ab-beaa-8c348134fc3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc193a0>]}
[0m13:11:30.851941 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_staging.stg_crypto_prices .............. [[32mCREATE VIEW[0m in 0.28s]
[0m13:11:30.853387 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m13:11:30.855735 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:30.856618 [debug] [MainThread]: On master: BEGIN
[0m13:11:30.857305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:30.900463 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m13:11:30.901784 [debug] [MainThread]: On master: COMMIT
[0m13:11:30.902780 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:30.903677 [debug] [MainThread]: On master: COMMIT
[0m13:11:30.904797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:30.905681 [debug] [MainThread]: On master: Close
[0m13:11:30.907045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:30.907969 [debug] [MainThread]: Connection 'model.dbt_project.stg_crypto_prices' was properly closed.
[0m13:11:30.909168 [info ] [MainThread]: 
[0m13:11:30.910734 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m13:11:30.912848 [debug] [MainThread]: Command end result
[0m13:11:30.969975 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m13:11:30.972769 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m13:11:30.984303 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m13:11:30.984987 [info ] [MainThread]: 
[0m13:11:30.985964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:30.986739 [info ] [MainThread]: 
[0m13:11:30.987392 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:30.989706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.40129, "process_in_blocks": "0", "process_kernel_time": 0.806374, "process_mem_max_rss": "116494336", "process_out_blocks": "0", "process_user_time": 5.886689}
[0m13:11:30.990641 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:30.990351 after 4.40 seconds
[0m13:11:30.992207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109833a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f85790>]}
[0m13:11:30.993456 [debug] [MainThread]: Flushing usage events
[0m13:11:31.540124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:00.570487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1efa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e535e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e535af0>]}


============================== 13:12:00.578376 | fc7cd166-7bd1-4cbe-a8b3-f97c89e58d74 ==============================
[0m13:12:00.578376 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:12:00.580259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m13:12:01.173839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc7cd166-7bd1-4cbe-a8b3-f97c89e58d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e947e20>]}
[0m13:12:01.277749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc7cd166-7bd1-4cbe-a8b3-f97c89e58d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da04f70>]}
[0m13:12:01.281825 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:12:01.929721 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:12:02.224148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:02.224816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:02.291995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc7cd166-7bd1-4cbe-a8b3-f97c89e58d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ce130>]}
[0m13:12:02.344249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc7cd166-7bd1-4cbe-a8b3-f97c89e58d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2baeb0>]}
[0m13:12:02.345331 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m13:12:02.346200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc7cd166-7bd1-4cbe-a8b3-f97c89e58d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2badf0>]}
[0m13:12:02.348850 [info ] [MainThread]: 
[0m13:12:02.350053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:02.351333 [info ] [MainThread]: 
[0m13:12:02.353313 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:12:02.355862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_public_staging'
[0m13:12:02.480311 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m13:12:02.481005 [debug] [ThreadPool]: On list_crypto_public_staging: BEGIN
[0m13:12:02.481545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:02.587532 [debug] [ThreadPool]: SQL status: BEGIN in 0.106 seconds
[0m13:12:02.589082 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m13:12:02.590506 [debug] [ThreadPool]: On list_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public_staging"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:12:02.638035 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.046 seconds
[0m13:12:02.642844 [debug] [ThreadPool]: On list_crypto_public_staging: ROLLBACK
[0m13:12:02.644350 [debug] [ThreadPool]: On list_crypto_public_staging: Close
[0m13:12:02.656737 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:02.657924 [debug] [MainThread]: On master: BEGIN
[0m13:12:02.658974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:02.693201 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m13:12:02.694065 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:02.694788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:12:02.747952 [debug] [MainThread]: SQL status: SELECT 1 in 0.052 seconds
[0m13:12:02.751475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc7cd166-7bd1-4cbe-a8b3-f97c89e58d74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f327400>]}
[0m13:12:02.752931 [debug] [MainThread]: On master: ROLLBACK
[0m13:12:02.753905 [debug] [MainThread]: On master: Close
[0m13:12:02.760013 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m13:12:02.761423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_crypto_public_staging, now model.dbt_project.stg_crypto_prices)
[0m13:12:02.762430 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m13:12:02.778087 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m13:12:02.779311 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m13:12:02.780576 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m13:12:02.782125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:02.782650 [debug] [MainThread]: Connection 'model.dbt_project.stg_crypto_prices' was properly closed.
[0m13:12:02.783641 [debug] [MainThread]: Command end result
[0m13:12:02.942052 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m13:12:02.949362 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m13:12:02.980020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m13:12:02.991645 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:12:02.993296 [info ] [MainThread]: Building catalog
[0m13:12:03.061534 [debug] [ThreadPool]: Acquiring new postgres connection 'crypto.information_schema'
[0m13:12:03.089054 [debug] [ThreadPool]: Using postgres connection "crypto.information_schema"
[0m13:12:03.090103 [debug] [ThreadPool]: On crypto.information_schema: BEGIN
[0m13:12:03.091276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:03.107519 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:12:03.108837 [debug] [ThreadPool]: Using postgres connection "crypto.information_schema"
[0m13:12:03.110419 [debug] [ThreadPool]: On crypto.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "crypto.information_schema"} */

    
    

    select
        'crypto' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_crypto_prices')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_crypto_prices')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:12:03.193542 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.081 seconds
[0m13:12:03.220854 [debug] [ThreadPool]: On crypto.information_schema: ROLLBACK
[0m13:12:03.237680 [debug] [ThreadPool]: On crypto.information_schema: Close
[0m13:12:03.291276 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/vaida/Playground/crypto_dbt_project/target/catalog.json
[0m13:12:03.371845 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m13:12:03.374509 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m13:12:03.375629 [info ] [MainThread]: Catalog written to /Users/vaida/Playground/crypto_dbt_project/target/catalog.json
[0m13:12:03.383589 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.9545386, "process_in_blocks": "0", "process_kernel_time": 0.748915, "process_mem_max_rss": "108040192", "process_out_blocks": "0", "process_user_time": 3.994062}
[0m13:12:03.384682 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:12:03.384473 after 2.96 seconds
[0m13:12:03.385404 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:12:03.386017 [debug] [MainThread]: Connection 'crypto.information_schema' was properly closed.
[0m13:12:03.386742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1efa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea88ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e947e20>]}
[0m13:12:03.388148 [debug] [MainThread]: Flushing usage events
[0m13:12:03.892129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:13.014764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f66fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109b4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109b4a00>]}


============================== 13:12:13.025294 | 3ecaf14f-d0d1-49b8-b726-97174d98a5ec ==============================
[0m13:12:13.025294 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:12:13.026620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:12:13.308825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ecaf14f-d0d1-49b8-b726-97174d98a5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d895b0>]}
[0m13:12:13.389029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ecaf14f-d0d1-49b8-b726-97174d98a5ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110986f40>]}
[0m13:32:42.285414 [error] [MainThread]: Encountered an error:

[0m13:32:42.431928 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m13:32:42.450170 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1229.5614, "process_in_blocks": "0", "process_kernel_time": 0.60966, "process_mem_max_rss": "95461376", "process_out_blocks": "0", "process_user_time": 2.945957}
[0m13:32:42.453339 [debug] [MainThread]: Command `dbt docs serve` failed at 13:32:42.452581 after 1229.57 seconds
[0m13:32:42.458559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f66fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fde4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f5edc0>]}
[0m13:32:42.460645 [debug] [MainThread]: Flushing usage events
[0m13:32:43.002034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:31.198094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b383250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3835b0>]}


============================== 14:04:31.211043 | cb47cf25-bb09-4356-b33c-0a8930e62978 ==============================
[0m14:04:31.211043 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:04:31.213710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:31.612977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb47cf25-bb09-4356-b33c-0a8930e62978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7aeb20>]}
[0m14:04:31.730509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb47cf25-bb09-4356-b33c-0a8930e62978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a774760>]}
[0m14:04:31.733552 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:04:32.037646 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:04:32.314209 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: staging/schema.yml - Runtime Error
    Syntax error near line 20
    ------------------------------
    17 |         description: "Price in USD"
    18 | 
    19 |   - name: int_crypto_metrics
    20 |       description: "Adds price % change and rolling average over 7 days"
    21 |       columns:
    22 |         - name: price_change_pct
    23 |           description: "Percent change from previous day"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 20, column 18
[0m14:04:32.325392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3122264, "process_in_blocks": "0", "process_kernel_time": 0.858328, "process_mem_max_rss": "97820672", "process_out_blocks": "0", "process_user_time": 3.584796}
[0m14:04:32.328228 [debug] [MainThread]: Command `dbt run` failed at 14:04:32.327811 after 1.32 seconds
[0m14:04:32.329783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0c4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0c4f10>]}
[0m14:04:32.330827 [debug] [MainThread]: Flushing usage events
[0m14:04:32.946798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:03.770030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a24a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d67f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d67be0>]}


============================== 14:05:03.782068 | 6fcecb4b-2af1-45f3-bdac-1ed6ff34556f ==============================
[0m14:05:03.782068 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:05:03.783465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:04.186219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fcecb4b-2af1-45f3-bdac-1ed6ff34556f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112150880>]}
[0m14:05:04.280018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fcecb4b-2af1-45f3-bdac-1ed6ff34556f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cf8ee0>]}
[0m14:05:04.281677 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:04.520084 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:05:04.676963 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_project: staging/schema.yml - Runtime Error
    Syntax error near line 19
    ------------------------------
    16 |       - name: price_usd
    17 |         description: "Price in USD"
    18 |   - name: int_crypto_metrics
    19 |       description: "Adds price % change and rolling average over 7 days"
    20 |       columns:
    21 |         - name: price_change_pct
    22 |           description: "Percent change from previous day"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 19, column 18
[0m14:05:04.679719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0583664, "process_in_blocks": "0", "process_kernel_time": 0.483469, "process_mem_max_rss": "96837632", "process_out_blocks": "0", "process_user_time": 3.122268}
[0m14:05:04.680644 [debug] [MainThread]: Command `dbt run` failed at 14:05:04.680457 after 1.06 seconds
[0m14:05:04.681282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a24a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ab5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ab5ee0>]}
[0m14:05:04.681881 [debug] [MainThread]: Flushing usage events
[0m14:05:05.164696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:28.591118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d562a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8a7ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8a7b80>]}


============================== 14:05:28.597959 | c73594db-26d2-4681-a3d5-d3615de8f07a ==============================
[0m14:05:28.597959 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:05:28.598992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:28.857086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c73594db-26d2-4681-a3d5-d3615de8f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec86ee0>]}
[0m14:05:28.936435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c73594db-26d2-4681-a3d5-d3615de8f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e870df0>]}
[0m14:05:28.937787 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:29.133178 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:05:29.429750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:05:29.430626 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt/models/intermediate/int_crypto_metrics.sql
[0m14:05:29.824813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c73594db-26d2-4681-a3d5-d3615de8f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f805130>]}
[0m14:05:29.940987 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:05:29.948376 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:05:30.008116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c73594db-26d2-4681-a3d5-d3615de8f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7ca1c0>]}
[0m14:05:30.011372 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m14:05:30.012394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c73594db-26d2-4681-a3d5-d3615de8f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f805520>]}
[0m14:05:30.016519 [info ] [MainThread]: 
[0m14:05:30.017564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:30.018370 [info ] [MainThread]: 
[0m14:05:30.019862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:30.035171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto'
[0m14:05:30.250115 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:05:30.251165 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:05:30.252030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:30.551796 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.300 seconds
[0m14:05:30.557564 [debug] [ThreadPool]: On list_crypto: Close
[0m14:05:30.568333 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:05:30.569660 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:05:30.571243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:30.603843 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.032 seconds
[0m14:05:30.607968 [debug] [ThreadPool]: On list_crypto: Close
[0m14:05:30.612810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto, now list_crypto_public)
[0m14:05:30.637529 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:05:30.638881 [debug] [ThreadPool]: On list_crypto_public: BEGIN
[0m14:05:30.640148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:30.658188 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m14:05:30.659016 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:05:30.659714 [debug] [ThreadPool]: On list_crypto_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:05:30.710151 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.050 seconds
[0m14:05:30.713760 [debug] [ThreadPool]: On list_crypto_public: ROLLBACK
[0m14:05:30.715346 [debug] [ThreadPool]: On list_crypto_public: Close
[0m14:05:30.717204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_public, now list_crypto_public_staging)
[0m14:05:30.726657 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:05:30.727381 [debug] [ThreadPool]: On list_crypto_public_staging: BEGIN
[0m14:05:30.727958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:30.755325 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m14:05:30.756548 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:05:30.757642 [debug] [ThreadPool]: On list_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public_staging"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:05:30.774902 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m14:05:30.779158 [debug] [ThreadPool]: On list_crypto_public_staging: ROLLBACK
[0m14:05:30.798533 [debug] [ThreadPool]: On list_crypto_public_staging: Close
[0m14:05:30.809113 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:30.810041 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.810730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:30.819680 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:05:30.820694 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:30.821874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:30.857356 [debug] [MainThread]: SQL status: SELECT 1 in 0.034 seconds
[0m14:05:30.860723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c73594db-26d2-4681-a3d5-d3615de8f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7ac040>]}
[0m14:05:30.861640 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:30.862688 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:30.863379 [debug] [MainThread]: On master: BEGIN
[0m14:05:30.864388 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:05:30.865028 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.865653 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:30.866426 [debug] [MainThread]: On master: COMMIT
[0m14:05:30.867345 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:30.868039 [debug] [MainThread]: On master: Close
[0m14:05:30.874081 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m14:05:30.875420 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_crypto_prices ................... [RUN]
[0m14:05:30.876633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_crypto_public_staging, now model.dbt_project.stg_crypto_prices)
[0m14:05:30.877593 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m14:05:30.900280 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m14:05:30.903436 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m14:05:30.985531 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_crypto_prices"
[0m14:05:30.987838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:05:30.988754 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: BEGIN
[0m14:05:30.989415 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:05:31.003841 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m14:05:31.004763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:05:31.005554 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */

  create view "crypto"."public_staging"."stg_crypto_prices__dbt_tmp"
    
    
  as (
    with source as (
    select * from "crypto"."public"."raw_crypto_prices"
),

renamed as (
    select
        coin_id,
        timestamp,
        price_usd
    from source
)

select * from renamed
  );
[0m14:05:31.025589 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.019 seconds
[0m14:05:31.039989 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:05:31.040933 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m14:05:31.050491 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.009 seconds
[0m14:05:31.057416 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:05:31.058270 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m14:05:31.059879 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:31.092872 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:05:31.093725 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:05:31.094369 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:05:31.099311 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m14:05:31.113322 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public_staging"."stg_crypto_prices__dbt_backup"
[0m14:05:31.122887 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:05:31.124041 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
drop view if exists "crypto"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m14:05:31.154218 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.029 seconds
[0m14:05:31.161635 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: Close
[0m14:05:31.166657 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c73594db-26d2-4681-a3d5-d3615de8f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1d08b0>]}
[0m14:05:31.168780 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public_staging.stg_crypto_prices .............. [[32mCREATE VIEW[0m in 0.29s]
[0m14:05:31.171852 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m14:05:31.174147 [debug] [Thread-1  ]: Began running node model.dbt_project.int_crypto_metrics
[0m14:05:31.175951 [info ] [Thread-1  ]: 2 of 2 START sql view model public.int_crypto_metrics .......................... [RUN]
[0m14:05:31.178025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.stg_crypto_prices, now model.dbt_project.int_crypto_metrics)
[0m14:05:31.179595 [debug] [Thread-1  ]: Began compiling node model.dbt_project.int_crypto_metrics
[0m14:05:31.198423 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.int_crypto_metrics"
[0m14:05:31.201247 [debug] [Thread-1  ]: Began executing node model.dbt_project.int_crypto_metrics
[0m14:05:31.220305 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.int_crypto_metrics"
[0m14:05:31.223795 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:05:31.225645 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: BEGIN
[0m14:05:31.227376 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:05:31.254937 [debug] [Thread-1  ]: SQL status: BEGIN in 0.028 seconds
[0m14:05:31.255940 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:05:31.256855 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */

  create view "crypto"."public"."int_crypto_metrics__dbt_tmp"
    
    
  as (
    with base as (
    select * from "crypto"."public_staging"."stg_crypto_prices"
),

with_changes as (
    select
        coin_id,
        timestamp::date as date,
        price_usd,
        lag(price_usd) over (partition by coin_id order by timestamp) as previous_price
    from base
),

with_pct_change as (
    select
        coin_id,
        date,
        price_usd,
        previous_price,
        round(
            case
                when previous_price is not null and previous_price != 0
                then 100.0 * (price_usd - previous_price) / previous_price
                else null
            end, 2
        ) as price_change_pct
    from with_changes
),

with_rolling as (
    select
        *,
        round(avg(price_usd) over (
            partition by coin_id
            order by date
            rows between 6 preceding and current row
        ), 2) as rolling_avg_7d
    from with_pct_change
)

select * from with_rolling
  );
[0m14:05:31.274864 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 26:         round(
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m14:05:31.276699 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: ROLLBACK
[0m14:05:31.279237 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: Close
[0m14:05:31.367906 [debug] [Thread-1  ]: Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 26:         round(
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql
[0m14:05:31.369884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c73594db-26d2-4681-a3d5-d3615de8f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e851eb0>]}
[0m14:05:31.372242 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public.int_crypto_metrics ................. [[31mERROR[0m in 0.19s]
[0m14:05:31.374917 [debug] [Thread-1  ]: Finished running node model.dbt_project.int_crypto_metrics
[0m14:05:31.377225 [debug] [Thread-4  ]: Marking all children of 'model.dbt_project.int_crypto_metrics' to be skipped because of status 'error'.  Reason: Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 26:         round(
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql.
[0m14:05:31.382192 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:31.385934 [debug] [MainThread]: On master: BEGIN
[0m14:05:31.388099 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:31.410555 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m14:05:31.413102 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.416226 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:31.417619 [debug] [MainThread]: On master: COMMIT
[0m14:05:31.419326 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:31.420938 [debug] [MainThread]: On master: Close
[0m14:05:31.422835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:31.424326 [debug] [MainThread]: Connection 'model.dbt_project.int_crypto_metrics' was properly closed.
[0m14:05:31.426130 [info ] [MainThread]: 
[0m14:05:31.428134 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m14:05:31.431267 [debug] [MainThread]: Command end result
[0m14:05:31.500188 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:05:31.503076 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:05:31.515530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m14:05:31.516261 [info ] [MainThread]: 
[0m14:05:31.517024 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:05:31.519033 [info ] [MainThread]: 
[0m14:05:31.524237 [error] [MainThread]:   Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 26:         round(
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql
[0m14:05:31.527205 [info ] [MainThread]: 
[0m14:05:31.528834 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:05:31.536189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0426188, "process_in_blocks": "0", "process_kernel_time": 0.517252, "process_mem_max_rss": "113315840", "process_out_blocks": "0", "process_user_time": 3.976728}
[0m14:05:31.538499 [debug] [MainThread]: Command `dbt run` failed at 14:05:31.538040 after 3.05 seconds
[0m14:05:31.540516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d562a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcc50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7ca1c0>]}
[0m14:05:31.547339 [debug] [MainThread]: Flushing usage events
[0m14:05:32.020596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:50.402763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae8fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1d4f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1d4be0>]}


============================== 14:08:50.414573 | 3696c1dd-a472-4a9c-93e0-7379f195f72a ==============================
[0m14:08:50.414573 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:08:50.417003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:50.813781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3696c1dd-a472-4a9c-93e0-7379f195f72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5f6700>]}
[0m14:08:50.921110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3696c1dd-a472-4a9c-93e0-7379f195f72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a0880>]}
[0m14:08:50.923179 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:08:51.533350 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:08:52.174864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:08:52.175871 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt/models/intermediate/int_crypto_metrics.sql
[0m14:08:52.631524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3696c1dd-a472-4a9c-93e0-7379f195f72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d137130>]}
[0m14:08:52.798483 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:08:52.806415 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:08:52.873857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3696c1dd-a472-4a9c-93e0-7379f195f72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7ce4c0>]}
[0m14:08:52.876193 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m14:08:52.883221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3696c1dd-a472-4a9c-93e0-7379f195f72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a0a30>]}
[0m14:08:52.887933 [info ] [MainThread]: 
[0m14:08:52.891608 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:52.895335 [info ] [MainThread]: 
[0m14:08:52.898903 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:08:52.918379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto'
[0m14:08:53.226340 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:08:53.227311 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:08:53.228114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:53.314832 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.087 seconds
[0m14:08:53.318094 [debug] [ThreadPool]: On list_crypto: Close
[0m14:08:53.325110 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:08:53.325994 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:08:53.326893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:53.336304 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m14:08:53.338485 [debug] [ThreadPool]: On list_crypto: Close
[0m14:08:53.340772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto, now list_crypto_public_staging)
[0m14:08:53.351059 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:08:53.351783 [debug] [ThreadPool]: On list_crypto_public_staging: BEGIN
[0m14:08:53.352316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:53.365985 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:08:53.366661 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:08:53.367236 [debug] [ThreadPool]: On list_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public_staging"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:08:53.372186 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m14:08:53.374794 [debug] [ThreadPool]: On list_crypto_public_staging: ROLLBACK
[0m14:08:53.375718 [debug] [ThreadPool]: On list_crypto_public_staging: Close
[0m14:08:53.376868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_public_staging, now list_crypto_public)
[0m14:08:53.381511 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:08:53.382155 [debug] [ThreadPool]: On list_crypto_public: BEGIN
[0m14:08:53.382702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:53.415674 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m14:08:53.416652 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:08:53.417446 [debug] [ThreadPool]: On list_crypto_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:08:53.425235 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m14:08:53.427769 [debug] [ThreadPool]: On list_crypto_public: ROLLBACK
[0m14:08:53.428757 [debug] [ThreadPool]: On list_crypto_public: Close
[0m14:08:53.443916 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.445874 [debug] [MainThread]: On master: BEGIN
[0m14:08:53.446562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:53.466296 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m14:08:53.467034 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.467881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:08:53.482061 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m14:08:53.484535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3696c1dd-a472-4a9c-93e0-7379f195f72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0cfdc0>]}
[0m14:08:53.485453 [debug] [MainThread]: On master: ROLLBACK
[0m14:08:53.486362 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.487034 [debug] [MainThread]: On master: BEGIN
[0m14:08:53.509979 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m14:08:53.511471 [debug] [MainThread]: On master: COMMIT
[0m14:08:53.513124 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.514339 [debug] [MainThread]: On master: COMMIT
[0m14:08:53.515553 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:53.516510 [debug] [MainThread]: On master: Close
[0m14:08:53.521819 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m14:08:53.523193 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_crypto_prices ................... [RUN]
[0m14:08:53.524579 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_crypto_public, now model.dbt_project.stg_crypto_prices)
[0m14:08:53.525470 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m14:08:53.544780 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m14:08:53.546274 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m14:08:53.610873 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_crypto_prices"
[0m14:08:53.612724 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:08:53.613427 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: BEGIN
[0m14:08:53.614022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:08:53.621094 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:08:53.621815 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:08:53.622428 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */

  create view "crypto"."public_staging"."stg_crypto_prices__dbt_tmp"
    
    
  as (
    with source as (
    select * from "crypto"."public"."raw_crypto_prices"
),

renamed as (
    select
        coin_id,
        timestamp,
        price_usd
    from source
)

select * from renamed
  );
[0m14:08:53.627355 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:08:53.638179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:08:53.638845 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m14:08:53.660612 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.021 seconds
[0m14:08:53.669892 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:08:53.670869 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m14:08:53.672330 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:08:53.701765 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:08:53.702464 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:08:53.703021 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:08:53.710333 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m14:08:53.720887 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public_staging"."stg_crypto_prices__dbt_backup"
[0m14:08:53.729031 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:08:53.729773 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
drop view if exists "crypto"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m14:08:53.732757 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m14:08:53.757797 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: Close
[0m14:08:53.778063 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3696c1dd-a472-4a9c-93e0-7379f195f72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c70cd60>]}
[0m14:08:53.791126 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public_staging.stg_crypto_prices .............. [[32mCREATE VIEW[0m in 0.25s]
[0m14:08:53.811701 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m14:08:53.814835 [debug] [Thread-1  ]: Began running node model.dbt_project.int_crypto_metrics
[0m14:08:53.817189 [info ] [Thread-1  ]: 2 of 2 START sql view model public.int_crypto_metrics .......................... [RUN]
[0m14:08:53.820355 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.stg_crypto_prices, now model.dbt_project.int_crypto_metrics)
[0m14:08:53.821912 [debug] [Thread-1  ]: Began compiling node model.dbt_project.int_crypto_metrics
[0m14:08:53.837450 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.int_crypto_metrics"
[0m14:08:53.842516 [debug] [Thread-1  ]: Began executing node model.dbt_project.int_crypto_metrics
[0m14:08:53.854096 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.int_crypto_metrics"
[0m14:08:53.857765 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:08:53.858997 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: BEGIN
[0m14:08:53.859812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:08:53.868411 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:08:53.869480 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:08:53.870324 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */

  create view "crypto"."public"."int_crypto_metrics__dbt_tmp"
    
    
  as (
    with base as (
    select * from "crypto"."public_staging"."stg_crypto_prices"
),

with_changes as (
    select
        coin_id,
        timestamp::date as date,
        price_usd,
        lag(price_usd) over (partition by coin_id order by timestamp) as previous_price
    from base
),

with_pct_change as (
    select
        coin_id,
        date,
        price_usd,
        previous_price,
        round(
            case
                when previous_price is not null and previous_price != 0
                then 100.0 * (price_usd - previous_price) / previous_price
                else null
            end::numeric, 2
        ) as price_change_pct
    from with_changes
),

with_rolling as (
    select
        *,
        round(avg(price_usd) over (
            partition by coin_id
            order by date
            rows between 6 preceding and current row
        ), 2) as rolling_avg_7d
    from with_pct_change
)

select * from with_rolling
  );
[0m14:08:53.877158 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 39:         round(avg(price_usd) over (
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m14:08:53.878579 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: ROLLBACK
[0m14:08:53.880512 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: Close
[0m14:08:53.954230 [debug] [Thread-1  ]: Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 39:         round(avg(price_usd) over (
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql
[0m14:08:53.955441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3696c1dd-a472-4a9c-93e0-7379f195f72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d613ca0>]}
[0m14:08:53.956664 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public.int_crypto_metrics ................. [[31mERROR[0m in 0.14s]
[0m14:08:53.957938 [debug] [Thread-1  ]: Finished running node model.dbt_project.int_crypto_metrics
[0m14:08:53.959223 [debug] [Thread-4  ]: Marking all children of 'model.dbt_project.int_crypto_metrics' to be skipped because of status 'error'.  Reason: Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 39:         round(avg(price_usd) over (
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql.
[0m14:08:53.961238 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.962169 [debug] [MainThread]: On master: BEGIN
[0m14:08:53.964003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:53.971464 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:08:53.972199 [debug] [MainThread]: On master: COMMIT
[0m14:08:53.972821 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.973430 [debug] [MainThread]: On master: COMMIT
[0m14:08:53.974778 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:53.976054 [debug] [MainThread]: On master: Close
[0m14:08:53.978607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:53.980460 [debug] [MainThread]: Connection 'model.dbt_project.int_crypto_metrics' was properly closed.
[0m14:08:53.981730 [info ] [MainThread]: 
[0m14:08:53.983624 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m14:08:53.986657 [debug] [MainThread]: Command end result
[0m14:08:54.049424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:08:54.052057 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:08:54.067511 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m14:08:54.068601 [info ] [MainThread]: 
[0m14:08:54.069851 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:08:54.070597 [info ] [MainThread]: 
[0m14:08:54.071321 [error] [MainThread]:   Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  function round(double precision, integer) does not exist
  LINE 39:         round(avg(price_usd) over (
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql
[0m14:08:54.071914 [info ] [MainThread]: 
[0m14:08:54.072517 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:08:54.078178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.8233507, "process_in_blocks": "0", "process_kernel_time": 1.06655, "process_mem_max_rss": "112930816", "process_out_blocks": "0", "process_user_time": 5.321252}
[0m14:08:54.081316 [debug] [MainThread]: Command `dbt run` failed at 14:08:54.080909 after 3.83 seconds
[0m14:08:54.084212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae8fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1be1f0>]}
[0m14:08:54.085637 [debug] [MainThread]: Flushing usage events
[0m14:08:54.626498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:32.245836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e7be0>]}


============================== 14:09:32.255365 | 16d1d192-266e-441f-be40-66aa3125f01e ==============================
[0m14:09:32.255365 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:09:32.256787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:09:32.577701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16d1d192-266e-441f-be40-66aa3125f01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108708700>]}
[0m14:09:32.656002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16d1d192-266e-441f-be40-66aa3125f01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b2880>]}
[0m14:09:32.658238 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:09:32.906145 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:09:33.214873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:09:33.216267 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt/models/intermediate/int_crypto_metrics.sql
[0m14:09:33.604025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16d1d192-266e-441f-be40-66aa3125f01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109249130>]}
[0m14:09:33.738491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:09:33.744395 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:09:33.806620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16d1d192-266e-441f-be40-66aa3125f01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088de4c0>]}
[0m14:09:33.808076 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m14:09:33.809009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16d1d192-266e-441f-be40-66aa3125f01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b7d30>]}
[0m14:09:33.812520 [info ] [MainThread]: 
[0m14:09:33.813593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:33.814579 [info ] [MainThread]: 
[0m14:09:33.820076 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:09:33.837596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto'
[0m14:09:34.060839 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:09:34.061891 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:09:34.062747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:34.130019 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.067 seconds
[0m14:09:34.133340 [debug] [ThreadPool]: On list_crypto: Close
[0m14:09:34.139393 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:09:34.140499 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:09:34.141446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:34.173857 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.032 seconds
[0m14:09:34.176674 [debug] [ThreadPool]: On list_crypto: Close
[0m14:09:34.179230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto, now list_crypto_public)
[0m14:09:34.192001 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:09:34.192790 [debug] [ThreadPool]: On list_crypto_public: BEGIN
[0m14:09:34.193408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:34.223264 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m14:09:34.224475 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:09:34.225285 [debug] [ThreadPool]: On list_crypto_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:09:34.231672 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:09:34.234167 [debug] [ThreadPool]: On list_crypto_public: ROLLBACK
[0m14:09:34.235265 [debug] [ThreadPool]: On list_crypto_public: Close
[0m14:09:34.236528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_public, now list_crypto_public_staging)
[0m14:09:34.241308 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:09:34.242572 [debug] [ThreadPool]: On list_crypto_public_staging: BEGIN
[0m14:09:34.243229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:34.273009 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m14:09:34.274468 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:09:34.275624 [debug] [ThreadPool]: On list_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public_staging"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:09:34.282482 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:09:34.285043 [debug] [ThreadPool]: On list_crypto_public_staging: ROLLBACK
[0m14:09:34.286158 [debug] [ThreadPool]: On list_crypto_public_staging: Close
[0m14:09:34.297207 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:34.298343 [debug] [MainThread]: On master: BEGIN
[0m14:09:34.299461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:34.321741 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m14:09:34.322644 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:34.323511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:09:34.336512 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m14:09:34.339614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16d1d192-266e-441f-be40-66aa3125f01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108745040>]}
[0m14:09:34.340552 [debug] [MainThread]: On master: ROLLBACK
[0m14:09:34.364858 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:34.369643 [debug] [MainThread]: On master: BEGIN
[0m14:09:34.371579 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:09:34.373199 [debug] [MainThread]: On master: COMMIT
[0m14:09:34.375708 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:34.379532 [debug] [MainThread]: On master: COMMIT
[0m14:09:34.381313 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:09:34.382411 [debug] [MainThread]: On master: Close
[0m14:09:34.388402 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m14:09:34.389752 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_crypto_prices ................... [RUN]
[0m14:09:34.390891 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_crypto_public_staging, now model.dbt_project.stg_crypto_prices)
[0m14:09:34.391789 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m14:09:34.408923 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m14:09:34.410370 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m14:09:34.506708 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_crypto_prices"
[0m14:09:34.508069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:09:34.508732 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: BEGIN
[0m14:09:34.509322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:34.518135 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m14:09:34.518991 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:09:34.519968 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */

  create view "crypto"."public_staging"."stg_crypto_prices__dbt_tmp"
    
    
  as (
    with source as (
    select * from "crypto"."public"."raw_crypto_prices"
),

renamed as (
    select
        coin_id,
        timestamp,
        price_usd
    from source
)

select * from renamed
  );
[0m14:09:34.527506 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:09:34.541035 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:09:34.541891 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m14:09:34.566355 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.023 seconds
[0m14:09:34.575691 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:09:34.576754 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m14:09:34.578658 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:09:34.613144 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:09:34.614003 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:09:34.614706 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:09:34.616693 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:09:34.630104 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public_staging"."stg_crypto_prices__dbt_backup"
[0m14:09:34.639612 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:09:34.640456 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
drop view if exists "crypto"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m14:09:34.665994 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.024 seconds
[0m14:09:34.673670 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: Close
[0m14:09:34.680491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16d1d192-266e-441f-be40-66aa3125f01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881ee20>]}
[0m14:09:34.682292 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public_staging.stg_crypto_prices .............. [[32mCREATE VIEW[0m in 0.28s]
[0m14:09:34.684133 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m14:09:34.685849 [debug] [Thread-1  ]: Began running node model.dbt_project.int_crypto_metrics
[0m14:09:34.687403 [info ] [Thread-1  ]: 2 of 2 START sql view model public.int_crypto_metrics .......................... [RUN]
[0m14:09:34.688564 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.stg_crypto_prices, now model.dbt_project.int_crypto_metrics)
[0m14:09:34.690183 [debug] [Thread-1  ]: Began compiling node model.dbt_project.int_crypto_metrics
[0m14:09:34.706121 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.int_crypto_metrics"
[0m14:09:34.708158 [debug] [Thread-1  ]: Began executing node model.dbt_project.int_crypto_metrics
[0m14:09:34.729060 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.int_crypto_metrics"
[0m14:09:34.731385 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:09:34.732484 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: BEGIN
[0m14:09:34.733845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:34.770682 [debug] [Thread-1  ]: SQL status: BEGIN in 0.037 seconds
[0m14:09:34.772129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:09:34.773535 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */

  create view "crypto"."public"."int_crypto_metrics__dbt_tmp"
    
    
  as (
    with base as (
    select * from "crypto"."public_staging"."stg_crypto_prices"
),

with_changes as (
    select
        coin_id,
        timestamp::date as date,
        price_usd,
        lag(price_usd) over (partition by coin_id order by timestamp) as previous_price
    from base
),

with_pct_change as (
    select
        coin_id,
        date,
        price_usd,
        previous_price,
        round(
            case
                when previous_price is not null and previous_price != 0
                then 100.0 * (price_usd - previous_price) / previous_price
                else null
            end::numeric, 2
        ) as price_change_pct
    from with_changes
),

with_rolling as (
    select
        *,
         round(avg(price_usd)::numeric, 2) over (
            partition by coin_id
            order by date
            rows between 6 preceding and current row
        ), 2) as rolling_avg_7d
    from with_pct_change
)

select * from with_rolling
  );
[0m14:09:34.777334 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 43:         ), 2) as rolling_avg_7d
                       ^

[0m14:09:34.778503 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: ROLLBACK
[0m14:09:34.780142 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: Close
[0m14:09:34.861630 [debug] [Thread-1  ]: Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  syntax error at or near "as"
  LINE 43:         ), 2) as rolling_avg_7d
                         ^
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql
[0m14:09:34.863344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16d1d192-266e-441f-be40-66aa3125f01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109723ca0>]}
[0m14:09:34.865320 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public.int_crypto_metrics ................. [[31mERROR[0m in 0.17s]
[0m14:09:34.867033 [debug] [Thread-1  ]: Finished running node model.dbt_project.int_crypto_metrics
[0m14:09:34.868453 [debug] [Thread-4  ]: Marking all children of 'model.dbt_project.int_crypto_metrics' to be skipped because of status 'error'.  Reason: Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  syntax error at or near "as"
  LINE 43:         ), 2) as rolling_avg_7d
                         ^
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql.
[0m14:09:34.871023 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:34.871922 [debug] [MainThread]: On master: BEGIN
[0m14:09:34.876212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:34.919191 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m14:09:34.920412 [debug] [MainThread]: On master: COMMIT
[0m14:09:34.921830 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:34.923316 [debug] [MainThread]: On master: COMMIT
[0m14:09:34.924893 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:09:34.926245 [debug] [MainThread]: On master: Close
[0m14:09:34.927902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:34.929426 [debug] [MainThread]: Connection 'model.dbt_project.int_crypto_metrics' was properly closed.
[0m14:09:34.931194 [info ] [MainThread]: 
[0m14:09:34.932924 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m14:09:34.935774 [debug] [MainThread]: Command end result
[0m14:09:35.017550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:09:35.020908 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:09:35.039955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m14:09:35.040730 [info ] [MainThread]: 
[0m14:09:35.041612 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:09:35.042493 [info ] [MainThread]: 
[0m14:09:35.043360 [error] [MainThread]:   Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  syntax error at or near "as"
  LINE 43:         ), 2) as rolling_avg_7d
                         ^
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql
[0m14:09:35.044112 [info ] [MainThread]: 
[0m14:09:35.044860 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:09:35.048308 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9215102, "process_in_blocks": "0", "process_kernel_time": 0.760415, "process_mem_max_rss": "111964160", "process_out_blocks": "0", "process_user_time": 4.574554}
[0m14:09:35.049278 [debug] [MainThread]: Command `dbt run` failed at 14:09:35.049084 after 2.92 seconds
[0m14:09:35.051448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b91f0>]}
[0m14:09:35.055535 [debug] [MainThread]: Flushing usage events
[0m14:09:35.598894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:25.456691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107914a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c57f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c57be0>]}


============================== 14:10:25.466325 | 1da244c4-e349-4929-a1ea-545eb9161072 ==============================
[0m14:10:25.466325 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:10:25.467531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:25.830442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1da244c4-e349-4929-a1ea-545eb9161072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109040880>]}
[0m14:10:25.913857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1da244c4-e349-4929-a1ea-545eb9161072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be8ee0>]}
[0m14:10:25.915897 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:10:26.162096 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:10:26.439322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:10:26.440149 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt/models/intermediate/int_crypto_metrics.sql
[0m14:10:26.907482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1da244c4-e349-4929-a1ea-545eb9161072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb9130>]}
[0m14:10:27.033588 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:10:27.038843 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:10:27.086875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1da244c4-e349-4929-a1ea-545eb9161072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b97a30>]}
[0m14:10:27.087784 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m14:10:27.088435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1da244c4-e349-4929-a1ea-545eb9161072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107320dc0>]}
[0m14:10:27.090790 [info ] [MainThread]: 
[0m14:10:27.091479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:27.092045 [info ] [MainThread]: 
[0m14:10:27.092881 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:10:27.099913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto'
[0m14:10:27.276265 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:10:27.277381 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:10:27.278266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:27.331273 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.053 seconds
[0m14:10:27.333520 [debug] [ThreadPool]: On list_crypto: Close
[0m14:10:27.338415 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:10:27.339203 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:10:27.339950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:27.374832 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.035 seconds
[0m14:10:27.377908 [debug] [ThreadPool]: On list_crypto: Close
[0m14:10:27.380417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto, now list_crypto_public_staging)
[0m14:10:27.392385 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:10:27.393097 [debug] [ThreadPool]: On list_crypto_public_staging: BEGIN
[0m14:10:27.393674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:27.424415 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m14:10:27.425492 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:10:27.426467 [debug] [ThreadPool]: On list_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public_staging"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:10:27.432880 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m14:10:27.435425 [debug] [ThreadPool]: On list_crypto_public_staging: ROLLBACK
[0m14:10:27.436517 [debug] [ThreadPool]: On list_crypto_public_staging: Close
[0m14:10:27.437936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_public_staging, now list_crypto_public)
[0m14:10:27.443199 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:10:27.443976 [debug] [ThreadPool]: On list_crypto_public: BEGIN
[0m14:10:27.444549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:27.473516 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m14:10:27.474520 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:10:27.475293 [debug] [ThreadPool]: On list_crypto_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:10:27.481289 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m14:10:27.483782 [debug] [ThreadPool]: On list_crypto_public: ROLLBACK
[0m14:10:27.484809 [debug] [ThreadPool]: On list_crypto_public: Close
[0m14:10:27.495006 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:27.495738 [debug] [MainThread]: On master: BEGIN
[0m14:10:27.496305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:27.523755 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m14:10:27.524570 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:27.525394 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:10:27.537935 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m14:10:27.540524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1da244c4-e349-4929-a1ea-545eb9161072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be8df0>]}
[0m14:10:27.541788 [debug] [MainThread]: On master: ROLLBACK
[0m14:10:27.565149 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:27.566674 [debug] [MainThread]: On master: BEGIN
[0m14:10:27.569024 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:10:27.570450 [debug] [MainThread]: On master: COMMIT
[0m14:10:27.571652 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:27.572379 [debug] [MainThread]: On master: COMMIT
[0m14:10:27.573351 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:10:27.574109 [debug] [MainThread]: On master: Close
[0m14:10:27.579465 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m14:10:27.580725 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_crypto_prices ................... [RUN]
[0m14:10:27.581864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_crypto_public, now model.dbt_project.stg_crypto_prices)
[0m14:10:27.582742 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m14:10:27.601885 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m14:10:27.603199 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m14:10:27.663895 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_crypto_prices"
[0m14:10:27.665138 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:10:27.665837 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: BEGIN
[0m14:10:27.666430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:10:27.673855 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:10:27.674596 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:10:27.675234 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */

  create view "crypto"."public_staging"."stg_crypto_prices__dbt_tmp"
    
    
  as (
    with source as (
    select * from "crypto"."public"."raw_crypto_prices"
),

renamed as (
    select
        coin_id,
        timestamp,
        price_usd
    from source
)

select * from renamed
  );
[0m14:10:27.679658 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:10:27.690574 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:10:27.691252 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m14:10:27.715878 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.024 seconds
[0m14:10:27.725904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:10:27.726806 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m14:10:27.728357 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:10:27.758323 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:10:27.759120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:10:27.759705 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:10:27.765818 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m14:10:27.777418 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public_staging"."stg_crypto_prices__dbt_backup"
[0m14:10:27.784815 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:10:27.785573 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
drop view if exists "crypto"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m14:10:27.787866 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m14:10:27.792346 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: Close
[0m14:10:27.795766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da244c4-e349-4929-a1ea-545eb9161072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109179550>]}
[0m14:10:27.797115 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public_staging.stg_crypto_prices .............. [[32mCREATE VIEW[0m in 0.21s]
[0m14:10:27.798129 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m14:10:27.799164 [debug] [Thread-1  ]: Began running node model.dbt_project.int_crypto_metrics
[0m14:10:27.799917 [info ] [Thread-1  ]: 2 of 2 START sql view model public.int_crypto_metrics .......................... [RUN]
[0m14:10:27.800661 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.stg_crypto_prices, now model.dbt_project.int_crypto_metrics)
[0m14:10:27.801256 [debug] [Thread-1  ]: Began compiling node model.dbt_project.int_crypto_metrics
[0m14:10:27.805993 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.int_crypto_metrics"
[0m14:10:27.807302 [debug] [Thread-1  ]: Began executing node model.dbt_project.int_crypto_metrics
[0m14:10:27.813880 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.int_crypto_metrics"
[0m14:10:27.817141 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:10:27.818495 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: BEGIN
[0m14:10:27.819561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:10:27.829338 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m14:10:27.830154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:10:27.830913 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */

  create view "crypto"."public"."int_crypto_metrics__dbt_tmp"
    
    
  as (
    with base as (
    select * from "crypto"."public_staging"."stg_crypto_prices"
),

with_changes as (
    select
        coin_id,
        timestamp::date as date,
        price_usd,
        lag(price_usd) over (partition by coin_id order by timestamp) as previous_price
    from base
),

with_pct_change as (
    select
        coin_id,
        date,
        price_usd,
        previous_price,
        round(
            case
                when previous_price is not null and previous_price != 0
                then 100.0 * (price_usd - previous_price) / previous_price
                else null
            end::numeric, 2
        ) as price_change_pct
    from with_changes
),

with_rolling as (
    select
        *,
        round(avg(price_usd)::numeric, 2) over (
            partition by coin_id
            order by date
            rows between 6 preceding and current row
        ) as rolling_avg_7d
    from with_pct_change
)

select * from with_rolling
  );
[0m14:10:27.835847 [debug] [Thread-1  ]: Postgres adapter: Postgres error: OVER specified, but round is not a window function nor an aggregate function
LINE 39:         round(avg(price_usd)::numeric, 2) over (
                 ^

[0m14:10:27.836668 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: ROLLBACK
[0m14:10:27.837653 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: Close
[0m14:10:27.901847 [debug] [Thread-1  ]: Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  OVER specified, but round is not a window function nor an aggregate function
  LINE 39:         round(avg(price_usd)::numeric, 2) over (
                   ^
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql
[0m14:10:27.902934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1da244c4-e349-4929-a1ea-545eb9161072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109179550>]}
[0m14:10:27.904067 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model public.int_crypto_metrics ................. [[31mERROR[0m in 0.10s]
[0m14:10:27.905291 [debug] [Thread-1  ]: Finished running node model.dbt_project.int_crypto_metrics
[0m14:10:27.906307 [debug] [Thread-4  ]: Marking all children of 'model.dbt_project.int_crypto_metrics' to be skipped because of status 'error'.  Reason: Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  OVER specified, but round is not a window function nor an aggregate function
  LINE 39:         round(avg(price_usd)::numeric, 2) over (
                   ^
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql.
[0m14:10:27.908137 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:27.908773 [debug] [MainThread]: On master: BEGIN
[0m14:10:27.909426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:27.919026 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:10:27.920181 [debug] [MainThread]: On master: COMMIT
[0m14:10:27.922410 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:27.923514 [debug] [MainThread]: On master: COMMIT
[0m14:10:27.924799 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:10:27.925822 [debug] [MainThread]: On master: Close
[0m14:10:27.927143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:27.928169 [debug] [MainThread]: Connection 'model.dbt_project.int_crypto_metrics' was properly closed.
[0m14:10:27.929399 [info ] [MainThread]: 
[0m14:10:27.930116 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m14:10:27.931623 [debug] [MainThread]: Command end result
[0m14:10:27.986254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:10:27.988686 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:10:27.999717 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m14:10:28.000324 [info ] [MainThread]: 
[0m14:10:28.000935 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:10:28.001504 [info ] [MainThread]: 
[0m14:10:28.002129 [error] [MainThread]:   Database Error in model int_crypto_metrics (dbt/models/intermediate/int_crypto_metrics.sql)
  OVER specified, but round is not a window function nor an aggregate function
  LINE 39:         round(avg(price_usd)::numeric, 2) over (
                   ^
  compiled code at target/run/dbt_project/dbt/models/intermediate/int_crypto_metrics.sql
[0m14:10:28.002707 [info ] [MainThread]: 
[0m14:10:28.003261 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:10:28.007549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6706128, "process_in_blocks": "0", "process_kernel_time": 0.834312, "process_mem_max_rss": "112328704", "process_out_blocks": "0", "process_user_time": 4.471176}
[0m14:10:28.008355 [debug] [MainThread]: Command `dbt run` failed at 14:10:28.008202 after 2.67 seconds
[0m14:10:28.009011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107914a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a15c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f7490>]}
[0m14:10:28.009650 [debug] [MainThread]: Flushing usage events
[0m14:10:28.466074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:51.566247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef54a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110298f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110298be0>]}


============================== 14:11:51.574813 | d3fac7dc-a6ee-4015-ace3-4dab6d0ba1a3 ==============================
[0m14:11:51.574813 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:11:51.575992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:11:51.896806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3fac7dc-a6ee-4015-ace3-4dab6d0ba1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110680880>]}
[0m14:11:51.985128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3fac7dc-a6ee-4015-ace3-4dab6d0ba1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110228ee0>]}
[0m14:11:51.987353 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:11:52.220652 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:11:52.482715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:52.483713 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt/models/intermediate/int_crypto_metrics.sql
[0m14:11:52.984410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3fac7dc-a6ee-4015-ace3-4dab6d0ba1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f9130>]}
[0m14:11:53.133136 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:11:53.141742 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:11:53.200378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3fac7dc-a6ee-4015-ace3-4dab6d0ba1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111d5a30>]}
[0m14:11:53.201620 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m14:11:53.202841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3fac7dc-a6ee-4015-ace3-4dab6d0ba1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e960dc0>]}
[0m14:11:53.206540 [info ] [MainThread]: 
[0m14:11:53.207761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:53.208853 [info ] [MainThread]: 
[0m14:11:53.212231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:53.226435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto'
[0m14:11:53.423661 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:11:53.424647 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:11:53.425450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:53.519185 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.094 seconds
[0m14:11:53.522203 [debug] [ThreadPool]: On list_crypto: Close
[0m14:11:53.527869 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:11:53.528768 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:11:53.529678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:53.552847 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m14:11:53.555291 [debug] [ThreadPool]: On list_crypto: Close
[0m14:11:53.557813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto, now list_crypto_public_staging)
[0m14:11:53.574724 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:11:53.575488 [debug] [ThreadPool]: On list_crypto_public_staging: BEGIN
[0m14:11:53.576084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:53.602929 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m14:11:53.603912 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:11:53.604861 [debug] [ThreadPool]: On list_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public_staging"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:11:53.612942 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m14:11:53.617450 [debug] [ThreadPool]: On list_crypto_public_staging: ROLLBACK
[0m14:11:53.618959 [debug] [ThreadPool]: On list_crypto_public_staging: Close
[0m14:11:53.620942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_public_staging, now list_crypto_public)
[0m14:11:53.627350 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:11:53.628058 [debug] [ThreadPool]: On list_crypto_public: BEGIN
[0m14:11:53.628646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:53.653799 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m14:11:53.654624 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:11:53.655327 [debug] [ThreadPool]: On list_crypto_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:11:53.663509 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m14:11:53.666881 [debug] [ThreadPool]: On list_crypto_public: ROLLBACK
[0m14:11:53.668058 [debug] [ThreadPool]: On list_crypto_public: Close
[0m14:11:53.677835 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:53.678587 [debug] [MainThread]: On master: BEGIN
[0m14:11:53.679157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:53.703792 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m14:11:53.704826 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:53.705908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:53.752649 [debug] [MainThread]: SQL status: SELECT 1 in 0.046 seconds
[0m14:11:53.755425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3fac7dc-a6ee-4015-ace3-4dab6d0ba1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110228df0>]}
[0m14:11:53.756334 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:53.757201 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:53.757981 [debug] [MainThread]: On master: BEGIN
[0m14:11:53.759060 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:11:53.759732 [debug] [MainThread]: On master: COMMIT
[0m14:11:53.760360 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:53.760980 [debug] [MainThread]: On master: COMMIT
[0m14:11:53.761862 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:53.762521 [debug] [MainThread]: On master: Close
[0m14:11:53.767880 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m14:11:53.768903 [info ] [Thread-1  ]: 1 of 2 START sql view model public_staging.stg_crypto_prices ................... [RUN]
[0m14:11:53.770058 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_crypto_public, now model.dbt_project.stg_crypto_prices)
[0m14:11:53.770876 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m14:11:53.784636 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m14:11:53.785939 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m14:11:53.846221 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_crypto_prices"
[0m14:11:53.848749 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:11:53.849491 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: BEGIN
[0m14:11:53.850039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:11:53.856970 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:11:53.857691 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:11:53.858325 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */

  create view "crypto"."public_staging"."stg_crypto_prices__dbt_tmp"
    
    
  as (
    with source as (
    select * from "crypto"."public"."raw_crypto_prices"
),

renamed as (
    select
        coin_id,
        timestamp,
        price_usd
    from source
)

select * from renamed
  );
[0m14:11:53.863387 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:11:53.874035 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:11:53.874754 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m14:11:53.895457 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.020 seconds
[0m14:11:53.902818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:11:53.903728 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m14:11:53.905299 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:11:53.933808 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:11:53.934540 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:11:53.935156 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:11:53.946019 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m14:11:53.958099 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public_staging"."stg_crypto_prices__dbt_backup"
[0m14:11:53.965305 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:11:53.966009 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
drop view if exists "crypto"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m14:11:53.969495 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m14:11:53.973867 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: Close
[0m14:11:53.977574 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3fac7dc-a6ee-4015-ace3-4dab6d0ba1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c3550>]}
[0m14:11:53.979015 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public_staging.stg_crypto_prices .............. [[32mCREATE VIEW[0m in 0.20s]
[0m14:11:53.980065 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m14:11:53.981193 [debug] [Thread-1  ]: Began running node model.dbt_project.int_crypto_metrics
[0m14:11:53.982023 [info ] [Thread-1  ]: 2 of 2 START sql view model public.int_crypto_metrics .......................... [RUN]
[0m14:11:53.982839 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.stg_crypto_prices, now model.dbt_project.int_crypto_metrics)
[0m14:11:53.983513 [debug] [Thread-1  ]: Began compiling node model.dbt_project.int_crypto_metrics
[0m14:11:53.990716 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.int_crypto_metrics"
[0m14:11:53.992073 [debug] [Thread-1  ]: Began executing node model.dbt_project.int_crypto_metrics
[0m14:11:53.999969 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.int_crypto_metrics"
[0m14:11:54.001299 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:11:54.001966 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: BEGIN
[0m14:11:54.002836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:11:54.012862 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m14:11:54.013787 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:11:54.014558 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */

  create view "crypto"."public"."int_crypto_metrics__dbt_tmp"
    
    
  as (
    with base as (
    select * from "crypto"."public_staging"."stg_crypto_prices"
),

with_changes as (
    select
        coin_id,
        timestamp::date as date,
        price_usd,
        lag(price_usd) over (partition by coin_id order by timestamp) as previous_price
    from base
),

with_pct_change as (
    select
        coin_id,
        date,
        price_usd,
        previous_price,
        round(
            case
                when previous_price is not null and previous_price != 0
                then 100.0 * (price_usd - previous_price) / previous_price
                else null
            end::numeric, 2
        ) as price_change_pct
    from with_changes
),

with_rolling as (
    select
        *,
        avg(price_usd) over (
            partition by coin_id
            order by date
            rows between 6 preceding and current row
        ) as raw_rolling_avg_7d
    from with_pct_change
)

select
    coin_id,
    date,
    price_usd,
    price_change_pct,
    round(raw_rolling_avg_7d::numeric, 2) as rolling_avg_7d
from with_rolling
  );
[0m14:11:54.063856 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.048 seconds
[0m14:11:54.071224 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:11:54.072177 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */
alter table "crypto"."public"."int_crypto_metrics__dbt_tmp" rename to "int_crypto_metrics"
[0m14:11:54.096284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.023 seconds
[0m14:11:54.102998 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: COMMIT
[0m14:11:54.104187 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:11:54.105199 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: COMMIT
[0m14:11:54.107081 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:11:54.112689 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public"."int_crypto_metrics__dbt_backup"
[0m14:11:54.114415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:11:54.115225 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */
drop view if exists "crypto"."public"."int_crypto_metrics__dbt_backup" cascade
[0m14:11:54.118193 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m14:11:54.121079 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: Close
[0m14:11:54.122311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3fac7dc-a6ee-4015-ace3-4dab6d0ba1a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c3550>]}
[0m14:11:54.123582 [info ] [Thread-1  ]: 2 of 2 OK created sql view model public.int_crypto_metrics ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m14:11:54.124847 [debug] [Thread-1  ]: Finished running node model.dbt_project.int_crypto_metrics
[0m14:11:54.126785 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:54.127513 [debug] [MainThread]: On master: BEGIN
[0m14:11:54.128142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:54.155816 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m14:11:54.157726 [debug] [MainThread]: On master: COMMIT
[0m14:11:54.158614 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:54.159355 [debug] [MainThread]: On master: COMMIT
[0m14:11:54.160584 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:54.161753 [debug] [MainThread]: On master: Close
[0m14:11:54.163064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:54.164274 [debug] [MainThread]: Connection 'model.dbt_project.int_crypto_metrics' was properly closed.
[0m14:11:54.165614 [info ] [MainThread]: 
[0m14:11:54.166457 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m14:11:54.168702 [debug] [MainThread]: Command end result
[0m14:11:54.223776 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:11:54.226333 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:11:54.237255 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m14:11:54.237882 [info ] [MainThread]: 
[0m14:11:54.238582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:54.239174 [info ] [MainThread]: 
[0m14:11:54.239788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:11:54.242251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7887185, "process_in_blocks": "0", "process_kernel_time": 0.749926, "process_mem_max_rss": "112168960", "process_out_blocks": "0", "process_user_time": 4.381598}
[0m14:11:54.243021 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:54.242867 after 2.79 seconds
[0m14:11:54.243651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef54a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6aa400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11113c9d0>]}
[0m14:11:54.244404 [debug] [MainThread]: Flushing usage events
[0m14:11:54.736789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:58.397297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112451a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137a50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137a5430>]}


============================== 14:26:58.409592 | aa0db47e-498a-4cbb-8291-7733b45ad40c ==============================
[0m14:26:58.409592 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:26:58.411131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:58.772008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa0db47e-498a-4cbb-8291-7733b45ad40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bb7700>]}
[0m14:26:58.866168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa0db47e-498a-4cbb-8291-7733b45ad40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113762880>]}
[0m14:26:58.868019 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:26:59.115260 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:26:59.418691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:26:59.419620 [debug] [MainThread]: Partial parsing: added file: dbt_project://dbt/models/marts/mart_top_coins.sql
[0m14:26:59.420455 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt/models/staging/schema.yml
[0m14:26:59.921686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa0db47e-498a-4cbb-8291-7733b45ad40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147c8100>]}
[0m14:27:00.063953 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:27:00.070487 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:27:00.221512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa0db47e-498a-4cbb-8291-7733b45ad40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146e8280>]}
[0m14:27:00.222833 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m14:27:00.223809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa0db47e-498a-4cbb-8291-7733b45ad40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11472d190>]}
[0m14:27:00.227103 [info ] [MainThread]: 
[0m14:27:00.228358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:00.229383 [info ] [MainThread]: 
[0m14:27:00.230887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:00.241671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto'
[0m14:27:00.383134 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:27:00.383904 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:27:00.384484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:00.460182 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.075 seconds
[0m14:27:00.464862 [debug] [ThreadPool]: On list_crypto: Close
[0m14:27:00.470970 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:27:00.471877 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:27:00.472588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:00.499618 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m14:27:00.502581 [debug] [ThreadPool]: On list_crypto: Close
[0m14:27:00.505429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto, now list_crypto_public)
[0m14:27:00.518518 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:27:00.519289 [debug] [ThreadPool]: On list_crypto_public: BEGIN
[0m14:27:00.519881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:00.549972 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m14:27:00.550884 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:27:00.551639 [debug] [ThreadPool]: On list_crypto_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:27:00.559127 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m14:27:00.562676 [debug] [ThreadPool]: On list_crypto_public: ROLLBACK
[0m14:27:00.563653 [debug] [ThreadPool]: On list_crypto_public: Close
[0m14:27:00.564900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_public, now list_crypto_public_staging)
[0m14:27:00.571542 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:27:00.572288 [debug] [ThreadPool]: On list_crypto_public_staging: BEGIN
[0m14:27:00.572893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:00.596944 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m14:27:00.597795 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:27:00.598545 [debug] [ThreadPool]: On list_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public_staging"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:27:00.604777 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m14:27:00.607530 [debug] [ThreadPool]: On list_crypto_public_staging: ROLLBACK
[0m14:27:00.608844 [debug] [ThreadPool]: On list_crypto_public_staging: Close
[0m14:27:00.618667 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:00.619479 [debug] [MainThread]: On master: BEGIN
[0m14:27:00.620098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:00.649094 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m14:27:00.650553 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:00.651970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:00.694255 [debug] [MainThread]: SQL status: SELECT 2 in 0.041 seconds
[0m14:27:00.700067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa0db47e-498a-4cbb-8291-7733b45ad40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bffca0>]}
[0m14:27:00.701248 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:00.702775 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:00.703734 [debug] [MainThread]: On master: BEGIN
[0m14:27:00.704996 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:27:00.705797 [debug] [MainThread]: On master: COMMIT
[0m14:27:00.706580 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:00.707307 [debug] [MainThread]: On master: COMMIT
[0m14:27:00.708200 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:00.708935 [debug] [MainThread]: On master: Close
[0m14:27:00.714247 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m14:27:00.715474 [info ] [Thread-1  ]: 1 of 3 START sql view model public_staging.stg_crypto_prices ................... [RUN]
[0m14:27:00.716531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_crypto_public_staging, now model.dbt_project.stg_crypto_prices)
[0m14:27:00.717392 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m14:27:00.732677 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m14:27:00.738176 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m14:27:00.824682 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_crypto_prices"
[0m14:27:00.827544 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:27:00.828402 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: BEGIN
[0m14:27:00.829005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:00.845886 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m14:27:00.846842 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:27:00.847561 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */

  create view "crypto"."public_staging"."stg_crypto_prices__dbt_tmp"
    
    
  as (
    with source as (
    select * from "crypto"."public"."raw_crypto_prices"
),

renamed as (
    select
        coin_id,
        timestamp,
        price_usd
    from source
)

select * from renamed
  );
[0m14:27:00.853857 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:27:00.866601 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:27:00.867434 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m14:27:00.890515 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.022 seconds
[0m14:27:00.902101 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:27:00.903080 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m14:27:00.907144 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:00.937880 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:27:00.938737 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:27:00.939362 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:27:00.941062 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:27:00.951673 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public_staging"."stg_crypto_prices__dbt_backup"
[0m14:27:00.959117 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:27:00.959943 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
drop view if exists "crypto"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m14:27:00.964352 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m14:27:00.968402 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: Close
[0m14:27:00.972282 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa0db47e-498a-4cbb-8291-7733b45ad40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114671a90>]}
[0m14:27:00.973733 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public_staging.stg_crypto_prices .............. [[32mCREATE VIEW[0m in 0.25s]
[0m14:27:00.974787 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m14:27:00.975996 [debug] [Thread-1  ]: Began running node model.dbt_project.int_crypto_metrics
[0m14:27:00.980452 [info ] [Thread-1  ]: 2 of 3 START sql view model public.int_crypto_metrics .......................... [RUN]
[0m14:27:00.982515 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.stg_crypto_prices, now model.dbt_project.int_crypto_metrics)
[0m14:27:00.984816 [debug] [Thread-1  ]: Began compiling node model.dbt_project.int_crypto_metrics
[0m14:27:00.991535 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.int_crypto_metrics"
[0m14:27:00.993021 [debug] [Thread-1  ]: Began executing node model.dbt_project.int_crypto_metrics
[0m14:27:01.021742 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.int_crypto_metrics"
[0m14:27:01.027080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:27:01.028209 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: BEGIN
[0m14:27:01.030630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:01.062953 [debug] [Thread-1  ]: SQL status: BEGIN in 0.032 seconds
[0m14:27:01.064575 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:27:01.066475 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */

  create view "crypto"."public"."int_crypto_metrics__dbt_tmp"
    
    
  as (
    with base as (
    select * from "crypto"."public_staging"."stg_crypto_prices"
),

with_changes as (
    select
        coin_id,
        timestamp::date as date,
        price_usd,
        lag(price_usd) over (partition by coin_id order by timestamp) as previous_price
    from base
),

with_pct_change as (
    select
        coin_id,
        date,
        price_usd,
        previous_price,
        round(
            case
                when previous_price is not null and previous_price != 0
                then 100.0 * (price_usd - previous_price) / previous_price
                else null
            end::numeric, 2
        ) as price_change_pct
    from with_changes
),

with_rolling as (
    select
        *,
        avg(price_usd) over (
            partition by coin_id
            order by date
            rows between 6 preceding and current row
        ) as raw_rolling_avg_7d
    from with_pct_change
)

select
    coin_id,
    date,
    price_usd,
    price_change_pct,
    round(raw_rolling_avg_7d::numeric, 2) as rolling_avg_7d
from with_rolling
  );
[0m14:27:01.102462 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.035 seconds
[0m14:27:01.111043 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:27:01.112076 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */
alter table "crypto"."public"."int_crypto_metrics__dbt_tmp" rename to "int_crypto_metrics"
[0m14:27:01.113868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:01.117082 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: COMMIT
[0m14:27:01.117952 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:27:01.118725 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: COMMIT
[0m14:27:01.140726 [debug] [Thread-1  ]: SQL status: COMMIT in 0.021 seconds
[0m14:27:01.149861 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public"."int_crypto_metrics__dbt_backup"
[0m14:27:01.151965 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:27:01.152862 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */
drop view if exists "crypto"."public"."int_crypto_metrics__dbt_backup" cascade
[0m14:27:01.154233 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:27:01.157117 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: Close
[0m14:27:01.158725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa0db47e-498a-4cbb-8291-7733b45ad40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123420d0>]}
[0m14:27:01.160258 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public.int_crypto_metrics ..................... [[32mCREATE VIEW[0m in 0.18s]
[0m14:27:01.161862 [debug] [Thread-1  ]: Finished running node model.dbt_project.int_crypto_metrics
[0m14:27:01.163470 [debug] [Thread-1  ]: Began running node model.dbt_project.mart_top_coins
[0m14:27:01.164564 [info ] [Thread-1  ]: 3 of 3 START sql view model public.mart_top_coins .............................. [RUN]
[0m14:27:01.165789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.int_crypto_metrics, now model.dbt_project.mart_top_coins)
[0m14:27:01.167144 [debug] [Thread-1  ]: Began compiling node model.dbt_project.mart_top_coins
[0m14:27:01.180517 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.mart_top_coins"
[0m14:27:01.183054 [debug] [Thread-1  ]: Began executing node model.dbt_project.mart_top_coins
[0m14:27:01.194967 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.mart_top_coins"
[0m14:27:01.197454 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.mart_top_coins"
[0m14:27:01.198636 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: BEGIN
[0m14:27:01.199767 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:27:01.215529 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m14:27:01.216788 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.mart_top_coins"
[0m14:27:01.217799 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.mart_top_coins"} */

  create view "crypto"."public"."mart_top_coins__dbt_tmp"
    
    
  as (
    with base as (
    select * from "crypto"."public"."int_crypto_metrics"
),

recent_data as (
    select *
    from base
    where date >= current_date - interval '30 days'
),

avg_by_coin as (
    select
        coin_id,
        round(avg(rolling_avg_7d)::numeric, 2) as avg_rolling_price
    from recent_data
    group by coin_id
)

select *
from avg_by_coin
order by avg_rolling_price desc
limit 5
  );
[0m14:27:01.254329 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.035 seconds
[0m14:27:01.269066 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.mart_top_coins"
[0m14:27:01.270360 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.mart_top_coins"} */
alter table "crypto"."public"."mart_top_coins__dbt_tmp" rename to "mart_top_coins"
[0m14:27:01.293102 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.021 seconds
[0m14:27:01.298361 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: COMMIT
[0m14:27:01.299460 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.mart_top_coins"
[0m14:27:01.300495 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: COMMIT
[0m14:27:01.302990 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:27:01.309702 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public"."mart_top_coins__dbt_backup"
[0m14:27:01.311878 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.mart_top_coins"
[0m14:27:01.312915 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.mart_top_coins"} */
drop view if exists "crypto"."public"."mart_top_coins__dbt_backup" cascade
[0m14:27:01.314252 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:27:01.317122 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: Close
[0m14:27:01.318420 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa0db47e-498a-4cbb-8291-7733b45ad40c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114be9f70>]}
[0m14:27:01.319751 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.mart_top_coins ......................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:27:01.320986 [debug] [Thread-1  ]: Finished running node model.dbt_project.mart_top_coins
[0m14:27:01.323224 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:01.323954 [debug] [MainThread]: On master: BEGIN
[0m14:27:01.324590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:01.350126 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m14:27:01.351128 [debug] [MainThread]: On master: COMMIT
[0m14:27:01.351869 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:01.352574 [debug] [MainThread]: On master: COMMIT
[0m14:27:01.353531 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:01.354691 [debug] [MainThread]: On master: Close
[0m14:27:01.356323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:01.357623 [debug] [MainThread]: Connection 'model.dbt_project.mart_top_coins' was properly closed.
[0m14:27:01.359169 [info ] [MainThread]: 
[0m14:27:01.362899 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m14:27:01.371762 [debug] [MainThread]: Command end result
[0m14:27:01.436610 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:27:01.439420 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:27:01.451218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m14:27:01.451921 [info ] [MainThread]: 
[0m14:27:01.452631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:01.453220 [info ] [MainThread]: 
[0m14:27:01.453836 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:27:01.458165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1832497, "process_in_blocks": "0", "process_kernel_time": 1.080716, "process_mem_max_rss": "113553408", "process_out_blocks": "0", "process_user_time": 5.01576}
[0m14:27:01.459215 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:01.459004 after 3.18 seconds
[0m14:27:01.460124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112451a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fca8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131df610>]}
[0m14:27:01.460955 [debug] [MainThread]: Flushing usage events
[0m14:27:01.965337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:52.825072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052afa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106604160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066044c0>]}


============================== 14:27:52.835772 | 68c51481-1266-4d57-81a0-c242417a1b64 ==============================
[0m14:27:52.835772 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:27:52.837114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:53.201882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68c51481-1266-4d57-81a0-c242417a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104147340>]}
[0m14:27:53.292416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68c51481-1266-4d57-81a0-c242417a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d79a0>]}
[0m14:27:53.294598 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:27:53.558091 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:27:53.880816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:53.881815 [debug] [MainThread]: Partial parsing: updated file: dbt_project://dbt/models/staging/schema.yml
[0m14:27:54.049302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68c51481-1266-4d57-81a0-c242417a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738a6d0>]}
[0m14:27:54.182657 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:27:54.188599 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:27:54.446657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68c51481-1266-4d57-81a0-c242417a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f6cd0>]}
[0m14:27:54.447991 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m14:27:54.449156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c51481-1266-4d57-81a0-c242417a1b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8faf0>]}
[0m14:27:54.452349 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:27:54.453791 [debug] [MainThread]: Command end result
[0m14:27:54.520658 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:27:54.523357 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:27:54.529805 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m14:27:54.532839 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.828217, "process_in_blocks": "0", "process_kernel_time": 0.800228, "process_mem_max_rss": "136151040", "process_out_blocks": "0", "process_user_time": 4.084842}
[0m14:27:54.533847 [debug] [MainThread]: Command `dbt test` succeeded at 14:27:54.533658 after 1.83 seconds
[0m14:27:54.534656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052afa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a464f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104147340>]}
[0m14:27:54.535444 [debug] [MainThread]: Flushing usage events
[0m14:27:55.093779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:11.990718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f14a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082651c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108265520>]}


============================== 14:28:12.000074 | 560ca2e1-1d90-4c05-aeaf-e21d2bf7ff1a ==============================
[0m14:28:12.000074 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:28:12.001316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m14:28:12.319208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '560ca2e1-1d90-4c05-aeaf-e21d2bf7ff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108669f40>]}
[0m14:28:12.399194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '560ca2e1-1d90-4c05-aeaf-e21d2bf7ff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b4460>]}
[0m14:28:12.401293 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:28:12.613567 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:28:12.929251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:12.933730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:13.013185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '560ca2e1-1d90-4c05-aeaf-e21d2bf7ff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffa130>]}
[0m14:28:13.081123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '560ca2e1-1d90-4c05-aeaf-e21d2bf7ff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109035460>]}
[0m14:28:13.082549 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m14:28:13.083706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '560ca2e1-1d90-4c05-aeaf-e21d2bf7ff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090353d0>]}
[0m14:28:13.087242 [info ] [MainThread]: 
[0m14:28:13.088213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:13.089445 [info ] [MainThread]: 
[0m14:28:13.090951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:13.101594 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto_public'
[0m14:28:13.237970 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:28:13.238719 [debug] [ThreadPool]: On list_crypto_public: BEGIN
[0m14:28:13.239318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:13.298105 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m14:28:13.299127 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:28:13.299898 [debug] [ThreadPool]: On list_crypto_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:28:13.306642 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m14:28:13.309406 [debug] [ThreadPool]: On list_crypto_public: ROLLBACK
[0m14:28:13.310459 [debug] [ThreadPool]: On list_crypto_public: Close
[0m14:28:13.311758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_public, now list_crypto_public_staging)
[0m14:28:13.317865 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:28:13.318615 [debug] [ThreadPool]: On list_crypto_public_staging: BEGIN
[0m14:28:13.319230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:13.351172 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m14:28:13.352228 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:28:13.353181 [debug] [ThreadPool]: On list_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public_staging"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:28:13.360822 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:28:13.363336 [debug] [ThreadPool]: On list_crypto_public_staging: ROLLBACK
[0m14:28:13.364306 [debug] [ThreadPool]: On list_crypto_public_staging: Close
[0m14:28:13.374235 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:13.375040 [debug] [MainThread]: On master: BEGIN
[0m14:28:13.375652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:13.401440 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m14:28:13.402502 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:13.403493 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:28:13.443882 [debug] [MainThread]: SQL status: SELECT 3 in 0.039 seconds
[0m14:28:13.450348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '560ca2e1-1d90-4c05-aeaf-e21d2bf7ff1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e86d0>]}
[0m14:28:13.451615 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:13.452894 [debug] [MainThread]: On master: Close
[0m14:28:13.459054 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m14:28:13.460730 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_crypto_public_staging, now model.dbt_project.stg_crypto_prices)
[0m14:28:13.461809 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m14:28:13.478444 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m14:28:13.481380 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m14:28:13.483256 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m14:28:13.484593 [debug] [Thread-1  ]: Began running node model.dbt_project.int_crypto_metrics
[0m14:28:13.485463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.stg_crypto_prices, now model.dbt_project.int_crypto_metrics)
[0m14:28:13.486538 [debug] [Thread-1  ]: Began compiling node model.dbt_project.int_crypto_metrics
[0m14:28:13.492420 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.int_crypto_metrics"
[0m14:28:13.495349 [debug] [Thread-1  ]: Began executing node model.dbt_project.int_crypto_metrics
[0m14:28:13.497085 [debug] [Thread-1  ]: Finished running node model.dbt_project.int_crypto_metrics
[0m14:28:13.498392 [debug] [Thread-1  ]: Began running node model.dbt_project.mart_top_coins
[0m14:28:13.499360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.int_crypto_metrics, now model.dbt_project.mart_top_coins)
[0m14:28:13.500156 [debug] [Thread-1  ]: Began compiling node model.dbt_project.mart_top_coins
[0m14:28:13.506019 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.mart_top_coins"
[0m14:28:13.507360 [debug] [Thread-1  ]: Began executing node model.dbt_project.mart_top_coins
[0m14:28:13.508722 [debug] [Thread-1  ]: Finished running node model.dbt_project.mart_top_coins
[0m14:28:13.510283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:13.510903 [debug] [MainThread]: Connection 'model.dbt_project.mart_top_coins' was properly closed.
[0m14:28:13.512620 [debug] [MainThread]: Command end result
[0m14:28:13.649968 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:28:13.656214 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:28:13.669254 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m14:28:13.680240 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:28:13.681277 [info ] [MainThread]: Building catalog
[0m14:28:13.700615 [debug] [ThreadPool]: Acquiring new postgres connection 'crypto.information_schema'
[0m14:28:13.720006 [debug] [ThreadPool]: Using postgres connection "crypto.information_schema"
[0m14:28:13.720787 [debug] [ThreadPool]: On crypto.information_schema: BEGIN
[0m14:28:13.721431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:13.751313 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m14:28:13.752406 [debug] [ThreadPool]: Using postgres connection "crypto.information_schema"
[0m14:28:13.753505 [debug] [ThreadPool]: On crypto.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "crypto.information_schema"} */

    
    

    select
        'crypto' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_crypto_prices')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_coins')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_crypto_metrics')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_crypto_prices')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:28:13.803216 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.048 seconds
[0m14:28:13.813554 [debug] [ThreadPool]: On crypto.information_schema: ROLLBACK
[0m14:28:13.814684 [debug] [ThreadPool]: On crypto.information_schema: Close
[0m14:28:13.837721 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/vaida/Playground/crypto_dbt_project/target/catalog.json
[0m14:28:13.962288 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:28:13.965616 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:28:13.966473 [info ] [MainThread]: Catalog written to /Users/vaida/Playground/crypto_dbt_project/target/catalog.json
[0m14:28:13.969495 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.0943842, "process_in_blocks": "0", "process_kernel_time": 0.774276, "process_mem_max_rss": "108937216", "process_out_blocks": "0", "process_user_time": 4.274942}
[0m14:28:13.970531 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:28:13.970324 after 2.10 seconds
[0m14:28:13.971271 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:28:13.971914 [debug] [MainThread]: Connection 'crypto.information_schema' was properly closed.
[0m14:28:13.972614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f14a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a34c0>]}
[0m14:28:13.973502 [debug] [MainThread]: Flushing usage events
[0m14:28:14.548753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:18.761941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2a49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ea100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ea460>]}


============================== 14:28:18.769858 | e7fc4fce-c297-4aee-bee2-5bd48fdbe507 ==============================
[0m14:28:18.769858 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:28:18.771198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:28:19.043991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7fc4fce-c297-4aee-bee2-5bd48fdbe507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109cafa0>]}
[0m14:28:19.132495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7fc4fce-c297-4aee-bee2-5bd48fdbe507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109dba00>]}
[0m14:29:08.831673 [error] [MainThread]: Encountered an error:

[0m14:29:08.933970 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m14:29:08.944482 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 50.302494, "process_in_blocks": "0", "process_kernel_time": 0.322898, "process_mem_max_rss": "93405184", "process_out_blocks": "0", "process_user_time": 2.626468}
[0m14:29:08.947520 [debug] [MainThread]: Command `dbt docs serve` failed at 14:29:08.946879 after 50.31 seconds
[0m14:29:08.949683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2a49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c64d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c64ee0>]}
[0m14:29:08.951329 [debug] [MainThread]: Flushing usage events
[0m14:29:09.415661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:53:17.586234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db4280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db45e0>]}


============================== 14:53:17.597591 | b44413a9-b364-43b5-a4e4-55e054ec81eb ==============================
[0m14:53:17.597591 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:53:17.599193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/vaida/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:53:18.081889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b44413a9-b364-43b5-a4e4-55e054ec81eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5e5e0>]}
[0m14:53:18.229063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b44413a9-b364-43b5-a4e4-55e054ec81eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b57f0>]}
[0m14:53:18.231898 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:53:18.544811 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:53:18.789010 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:53:18.790085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b44413a9-b364-43b5-a4e4-55e054ec81eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082189a0>]}
[0m14:53:20.586582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b44413a9-b364-43b5-a4e4-55e054ec81eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d79130>]}
[0m14:53:20.693505 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:53:20.700067 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:53:20.767303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b44413a9-b364-43b5-a4e4-55e054ec81eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e13d00>]}
[0m14:53:20.769488 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m14:53:20.770432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44413a9-b364-43b5-a4e4-55e054ec81eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d937c0>]}
[0m14:53:20.773793 [info ] [MainThread]: 
[0m14:53:20.774969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:20.775797 [info ] [MainThread]: 
[0m14:53:20.777019 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:20.787222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:53:20.914180 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:53:20.915029 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:53:20.915644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:21.016413 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.101 seconds
[0m14:53:21.019712 [debug] [ThreadPool]: On list_postgres: Close
[0m14:53:21.025788 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:53:21.026803 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:53:21.027614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:21.037687 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m14:53:21.040365 [debug] [ThreadPool]: On list_postgres: Close
[0m14:53:21.041875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_staging)
[0m14:53:21.043576 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_staging"
"
[0m14:53:21.054240 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m14:53:21.055061 [debug] [ThreadPool]: On create_postgres_public_staging: BEGIN
[0m14:53:21.055684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:21.064727 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:53:21.065665 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m14:53:21.066341 [debug] [ThreadPool]: On create_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_postgres_public_staging"} */
create schema if not exists "public_staging"
[0m14:53:21.079166 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.012 seconds
[0m14:53:21.082483 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m14:53:21.083484 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_staging"
[0m14:53:21.084304 [debug] [ThreadPool]: On create_postgres_public_staging: COMMIT
[0m14:53:21.085971 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:53:21.086797 [debug] [ThreadPool]: On create_postgres_public_staging: Close
[0m14:53:21.089920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_staging, now list_postgres_public)
[0m14:53:21.102375 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m14:53:21.103195 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m14:53:21.103818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:21.111193 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:53:21.111964 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m14:53:21.112618 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:53:21.136155 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m14:53:21.138809 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m14:53:21.139809 [debug] [ThreadPool]: On list_postgres_public: Close
[0m14:53:21.141346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m14:53:21.146717 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:53:21.147564 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m14:53:21.148240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:21.156614 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:53:21.157409 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m14:53:21.158092 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:53:21.163664 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m14:53:21.165968 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m14:53:21.166919 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m14:53:21.175350 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:21.176092 [debug] [MainThread]: On master: BEGIN
[0m14:53:21.176663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:21.183926 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:53:21.184746 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:21.185472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:21.206468 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m14:53:21.208989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44413a9-b364-43b5-a4e4-55e054ec81eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb2a90>]}
[0m14:53:21.209984 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:21.210979 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:21.211749 [debug] [MainThread]: On master: BEGIN
[0m14:53:21.213078 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:53:21.213855 [debug] [MainThread]: On master: COMMIT
[0m14:53:21.214532 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:21.215190 [debug] [MainThread]: On master: COMMIT
[0m14:53:21.216013 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:53:21.216678 [debug] [MainThread]: On master: Close
[0m14:53:21.221376 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m14:53:21.222557 [info ] [Thread-1  ]: 1 of 3 START sql view model public_staging.stg_crypto_prices ................... [RUN]
[0m14:53:21.223529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now model.dbt_project.stg_crypto_prices)
[0m14:53:21.224307 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m14:53:21.245398 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m14:53:21.246963 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m14:53:21.317316 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_crypto_prices"
[0m14:53:21.322038 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:53:21.323064 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: BEGIN
[0m14:53:21.323873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:53:21.331372 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:53:21.332224 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:53:21.333030 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */

  create view "postgres"."public_staging"."stg_crypto_prices__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."public"."raw_crypto_prices"
),

renamed as (
    select
        coin_id,
        timestamp,
        price_usd
    from source
)

select * from renamed
  );
[0m14:53:21.336099 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.raw_crypto_prices" does not exist
LINE 8:     select * from "postgres"."public"."raw_crypto_prices"
                          ^

[0m14:53:21.337228 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: ROLLBACK
[0m14:53:21.338493 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: Close
[0m14:53:21.406021 [debug] [Thread-1  ]: Database Error in model stg_crypto_prices (dbt/models/staging/stg_crypto_prices.sql)
  relation "public.raw_crypto_prices" does not exist
  LINE 8:     select * from "postgres"."public"."raw_crypto_prices"
                            ^
  compiled code at target/run/dbt_project/dbt/models/staging/stg_crypto_prices.sql
[0m14:53:21.410635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44413a9-b364-43b5-a4e4-55e054ec81eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26a0d0>]}
[0m14:53:21.412481 [error] [Thread-1  ]: 1 of 3 ERROR creating sql view model public_staging.stg_crypto_prices .......... [[31mERROR[0m in 0.18s]
[0m14:53:21.413914 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m14:53:21.415144 [debug] [Thread-4  ]: Marking all children of 'model.dbt_project.stg_crypto_prices' to be skipped because of status 'error'.  Reason: Database Error in model stg_crypto_prices (dbt/models/staging/stg_crypto_prices.sql)
  relation "public.raw_crypto_prices" does not exist
  LINE 8:     select * from "postgres"."public"."raw_crypto_prices"
                            ^
  compiled code at target/run/dbt_project/dbt/models/staging/stg_crypto_prices.sql.
[0m14:53:21.416569 [debug] [Thread-1  ]: Began running node model.dbt_project.int_crypto_metrics
[0m14:53:21.417577 [info ] [Thread-1  ]: 2 of 3 SKIP relation public.int_crypto_metrics ................................. [[33mSKIP[0m]
[0m14:53:21.418504 [debug] [Thread-1  ]: Finished running node model.dbt_project.int_crypto_metrics
[0m14:53:21.419735 [debug] [Thread-1  ]: Began running node model.dbt_project.mart_top_coins
[0m14:53:21.420673 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.mart_top_coins ..................................... [[33mSKIP[0m]
[0m14:53:21.421621 [debug] [Thread-1  ]: Finished running node model.dbt_project.mart_top_coins
[0m14:53:21.423662 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:21.424357 [debug] [MainThread]: On master: BEGIN
[0m14:53:21.424946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:21.438616 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m14:53:21.439468 [debug] [MainThread]: On master: COMMIT
[0m14:53:21.440208 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:21.441540 [debug] [MainThread]: On master: COMMIT
[0m14:53:21.444942 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:53:21.447781 [debug] [MainThread]: On master: Close
[0m14:53:21.449093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:21.449779 [debug] [MainThread]: Connection 'model.dbt_project.stg_crypto_prices' was properly closed.
[0m14:53:21.450631 [info ] [MainThread]: 
[0m14:53:21.451728 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m14:53:21.453693 [debug] [MainThread]: Command end result
[0m14:53:21.535009 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:53:21.538559 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:53:21.550124 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m14:53:21.550817 [info ] [MainThread]: 
[0m14:53:21.551537 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:53:21.552149 [info ] [MainThread]: 
[0m14:53:21.552892 [error] [MainThread]:   Database Error in model stg_crypto_prices (dbt/models/staging/stg_crypto_prices.sql)
  relation "public.raw_crypto_prices" does not exist
  LINE 8:     select * from "postgres"."public"."raw_crypto_prices"
                            ^
  compiled code at target/run/dbt_project/dbt/models/staging/stg_crypto_prices.sql
[0m14:53:21.553499 [info ] [MainThread]: 
[0m14:53:21.554117 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m14:53:21.562771 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.1426177, "process_in_blocks": "0", "process_kernel_time": 0.887163, "process_mem_max_rss": "113008640", "process_out_blocks": "0", "process_user_time": 5.940242}
[0m14:53:21.564547 [debug] [MainThread]: Command `dbt run` failed at 14:53:21.564059 after 4.15 seconds
[0m14:53:21.568357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d5e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e13f70>]}
[0m14:53:21.572131 [debug] [MainThread]: Flushing usage events
[0m14:53:22.125416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:53:44.439304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110531ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111875cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111875970>]}


============================== 14:53:44.446659 | e3fd6657-40c1-4b27-8ea7-f8a812d9827c ==============================
[0m14:53:44.446659 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:53:44.447796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/vaida/Playground/crypto_dbt_project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:53:44.725895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3fd6657-40c1-4b27-8ea7-f8a812d9827c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3c7ca0>]}
[0m14:53:44.814515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3fd6657-40c1-4b27-8ea7-f8a812d9827c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c47880>]}
[0m14:53:44.815770 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:53:45.021354 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:53:45.165769 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:53:45.166556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3fd6657-40c1-4b27-8ea7-f8a812d9827c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cc7430>]}
[0m14:53:46.856380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3fd6657-40c1-4b27-8ea7-f8a812d9827c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112849130>]}
[0m14:53:46.967215 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:53:46.971124 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:53:46.988794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3fd6657-40c1-4b27-8ea7-f8a812d9827c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128df8b0>]}
[0m14:53:46.989611 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m14:53:46.990220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3fd6657-40c1-4b27-8ea7-f8a812d9827c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126746a0>]}
[0m14:53:46.992508 [info ] [MainThread]: 
[0m14:53:46.993149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:46.993672 [info ] [MainThread]: 
[0m14:53:46.994465 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:47.001310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_crypto'
[0m14:53:47.097728 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:53:47.098436 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:53:47.098944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:47.135119 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m14:53:47.137589 [debug] [ThreadPool]: On list_crypto: Close
[0m14:53:47.142812 [debug] [ThreadPool]: Using postgres connection "list_crypto"
[0m14:53:47.143662 [debug] [ThreadPool]: On list_crypto: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto"} */

    select distinct nspname from pg_namespace
  
[0m14:53:47.144280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:47.180800 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m14:53:47.183556 [debug] [ThreadPool]: On list_crypto: Close
[0m14:53:47.186224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto, now list_crypto_public_staging)
[0m14:53:47.200336 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:53:47.201139 [debug] [ThreadPool]: On list_crypto_public_staging: BEGIN
[0m14:53:47.201903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:47.230787 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m14:53:47.231855 [debug] [ThreadPool]: Using postgres connection "list_crypto_public_staging"
[0m14:53:47.232798 [debug] [ThreadPool]: On list_crypto_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public_staging"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:53:47.240198 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:53:47.242778 [debug] [ThreadPool]: On list_crypto_public_staging: ROLLBACK
[0m14:53:47.243813 [debug] [ThreadPool]: On list_crypto_public_staging: Close
[0m14:53:47.245088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_public_staging, now list_crypto_public)
[0m14:53:47.250405 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:53:47.251163 [debug] [ThreadPool]: On list_crypto_public: BEGIN
[0m14:53:47.251807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:47.282069 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m14:53:47.283326 [debug] [ThreadPool]: Using postgres connection "list_crypto_public"
[0m14:53:47.284133 [debug] [ThreadPool]: On list_crypto_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_crypto_public"} */
select
      'crypto' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'crypto' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:53:47.290494 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m14:53:47.293120 [debug] [ThreadPool]: On list_crypto_public: ROLLBACK
[0m14:53:47.294078 [debug] [ThreadPool]: On list_crypto_public: Close
[0m14:53:47.303903 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:47.304721 [debug] [MainThread]: On master: BEGIN
[0m14:53:47.305344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:47.330864 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m14:53:47.331926 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:47.333024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:47.380223 [debug] [MainThread]: SQL status: SELECT 3 in 0.046 seconds
[0m14:53:47.384890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3fd6657-40c1-4b27-8ea7-f8a812d9827c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11271baf0>]}
[0m14:53:47.385837 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:47.386989 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:47.387748 [debug] [MainThread]: On master: BEGIN
[0m14:53:47.388838 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:53:47.389533 [debug] [MainThread]: On master: COMMIT
[0m14:53:47.390205 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:47.390842 [debug] [MainThread]: On master: COMMIT
[0m14:53:47.391713 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:53:47.392411 [debug] [MainThread]: On master: Close
[0m14:53:47.395956 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m14:53:47.397235 [info ] [Thread-1  ]: 1 of 3 START sql view model public_staging.stg_crypto_prices ................... [RUN]
[0m14:53:47.398270 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_crypto_public, now model.dbt_project.stg_crypto_prices)
[0m14:53:47.399053 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m14:53:47.413889 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m14:53:47.415143 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m14:53:47.492243 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_crypto_prices"
[0m14:53:47.493636 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:53:47.494305 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: BEGIN
[0m14:53:47.494856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:53:47.531077 [debug] [Thread-1  ]: SQL status: BEGIN in 0.036 seconds
[0m14:53:47.531982 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:53:47.532767 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */

  create view "crypto"."public_staging"."stg_crypto_prices__dbt_tmp"
    
    
  as (
    with source as (
    select * from "crypto"."public"."raw_crypto_prices"
),

renamed as (
    select
        coin_id,
        timestamp,
        price_usd
    from source
)

select * from renamed
  );
[0m14:53:47.537540 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:53:47.550123 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:53:47.550925 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices" rename to "stg_crypto_prices__dbt_backup"
[0m14:53:47.573401 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.021 seconds
[0m14:53:47.585420 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:53:47.586343 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
alter table "crypto"."public_staging"."stg_crypto_prices__dbt_tmp" rename to "stg_crypto_prices"
[0m14:53:47.587791 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:53:47.621109 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:53:47.622067 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:53:47.622771 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: COMMIT
[0m14:53:47.625140 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:53:47.638143 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public_staging"."stg_crypto_prices__dbt_backup"
[0m14:53:47.648010 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_crypto_prices"
[0m14:53:47.648827 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_crypto_prices"} */
drop view if exists "crypto"."public_staging"."stg_crypto_prices__dbt_backup" cascade
[0m14:53:47.666278 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.016 seconds
[0m14:53:47.672779 [debug] [Thread-1  ]: On model.dbt_project.stg_crypto_prices: Close
[0m14:53:47.677932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3fd6657-40c1-4b27-8ea7-f8a812d9827c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d6db50>]}
[0m14:53:47.679414 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public_staging.stg_crypto_prices .............. [[32mCREATE VIEW[0m in 0.28s]
[0m14:53:47.680756 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m14:53:47.682340 [debug] [Thread-1  ]: Began running node model.dbt_project.int_crypto_metrics
[0m14:53:47.683542 [info ] [Thread-1  ]: 2 of 3 START sql view model public.int_crypto_metrics .......................... [RUN]
[0m14:53:47.684726 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.stg_crypto_prices, now model.dbt_project.int_crypto_metrics)
[0m14:53:47.685535 [debug] [Thread-1  ]: Began compiling node model.dbt_project.int_crypto_metrics
[0m14:53:47.702819 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.int_crypto_metrics"
[0m14:53:47.705056 [debug] [Thread-1  ]: Began executing node model.dbt_project.int_crypto_metrics
[0m14:53:47.721256 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.int_crypto_metrics"
[0m14:53:47.723284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:53:47.724737 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: BEGIN
[0m14:53:47.726177 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:53:47.740817 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m14:53:47.741942 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:53:47.743126 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */

  create view "crypto"."public"."int_crypto_metrics__dbt_tmp"
    
    
  as (
    with base as (
    select * from "crypto"."public_staging"."stg_crypto_prices"
),

with_changes as (
    select
        coin_id,
        timestamp::date as date,
        price_usd,
        lag(price_usd) over (partition by coin_id order by timestamp) as previous_price
    from base
),

with_pct_change as (
    select
        coin_id,
        date,
        price_usd,
        previous_price,
        round(
            case
                when previous_price is not null and previous_price != 0
                then 100.0 * (price_usd - previous_price) / previous_price
                else null
            end::numeric, 2
        ) as price_change_pct
    from with_changes
),

with_rolling as (
    select
        *,
        avg(price_usd) over (
            partition by coin_id
            order by date
            rows between 6 preceding and current row
        ) as raw_rolling_avg_7d
    from with_pct_change
)

select
    coin_id,
    date,
    price_usd,
    price_change_pct,
    round(raw_rolling_avg_7d::numeric, 2) as rolling_avg_7d
from with_rolling
  );
[0m14:53:47.771258 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.027 seconds
[0m14:53:47.780500 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:53:47.781647 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */
alter table "crypto"."public"."int_crypto_metrics__dbt_tmp" rename to "int_crypto_metrics"
[0m14:53:47.783724 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:53:47.788017 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: COMMIT
[0m14:53:47.789100 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:53:47.790111 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: COMMIT
[0m14:53:47.791988 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:53:47.798944 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public"."int_crypto_metrics__dbt_backup"
[0m14:53:47.800780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.int_crypto_metrics"
[0m14:53:47.801599 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_crypto_metrics"} */
drop view if exists "crypto"."public"."int_crypto_metrics__dbt_backup" cascade
[0m14:53:47.810613 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.008 seconds
[0m14:53:47.814667 [debug] [Thread-1  ]: On model.dbt_project.int_crypto_metrics: Close
[0m14:53:47.816526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3fd6657-40c1-4b27-8ea7-f8a812d9827c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea67f0>]}
[0m14:53:47.818842 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public.int_crypto_metrics ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:53:47.820563 [debug] [Thread-1  ]: Finished running node model.dbt_project.int_crypto_metrics
[0m14:53:47.822391 [debug] [Thread-1  ]: Began running node model.dbt_project.mart_top_coins
[0m14:53:47.823871 [info ] [Thread-1  ]: 3 of 3 START sql view model public.mart_top_coins .............................. [RUN]
[0m14:53:47.825164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.int_crypto_metrics, now model.dbt_project.mart_top_coins)
[0m14:53:47.826126 [debug] [Thread-1  ]: Began compiling node model.dbt_project.mart_top_coins
[0m14:53:47.840184 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.mart_top_coins"
[0m14:53:47.843529 [debug] [Thread-1  ]: Began executing node model.dbt_project.mart_top_coins
[0m14:53:47.962172 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.mart_top_coins"
[0m14:53:47.964268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.mart_top_coins"
[0m14:53:47.965352 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: BEGIN
[0m14:53:47.966278 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:53:47.977904 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m14:53:47.979022 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.mart_top_coins"
[0m14:53:47.980184 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.mart_top_coins"} */

  create view "crypto"."public"."mart_top_coins__dbt_tmp"
    
    
  as (
    with base as (
    select * from "crypto"."public"."int_crypto_metrics"
),

recent_data as (
    select *
    from base
    where date >= current_date - interval '30 days'
),

avg_by_coin as (
    select
        coin_id,
        round(avg(rolling_avg_7d)::numeric, 2) as avg_rolling_price
    from recent_data
    group by coin_id
)

select *
from avg_by_coin
order by avg_rolling_price desc
limit 5
  );
[0m14:53:47.988523 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:53:47.996849 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.mart_top_coins"
[0m14:53:47.998043 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.mart_top_coins"} */
alter table "crypto"."public"."mart_top_coins__dbt_tmp" rename to "mart_top_coins"
[0m14:53:48.011065 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.012 seconds
[0m14:53:48.016691 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: COMMIT
[0m14:53:48.018094 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.mart_top_coins"
[0m14:53:48.019180 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: COMMIT
[0m14:53:48.021159 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m14:53:48.027936 [debug] [Thread-1  ]: Applying DROP to: "crypto"."public"."mart_top_coins__dbt_backup"
[0m14:53:48.030541 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.mart_top_coins"
[0m14:53:48.031622 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.mart_top_coins"} */
drop view if exists "crypto"."public"."mart_top_coins__dbt_backup" cascade
[0m14:53:48.033074 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m14:53:48.036775 [debug] [Thread-1  ]: On model.dbt_project.mart_top_coins: Close
[0m14:53:48.038950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3fd6657-40c1-4b27-8ea7-f8a812d9827c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112edfb50>]}
[0m14:53:48.041514 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.mart_top_coins ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m14:53:48.043568 [debug] [Thread-1  ]: Finished running node model.dbt_project.mart_top_coins
[0m14:53:48.045933 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:48.047076 [debug] [MainThread]: On master: BEGIN
[0m14:53:48.047838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:48.077360 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m14:53:48.079214 [debug] [MainThread]: On master: COMMIT
[0m14:53:48.080572 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:48.081983 [debug] [MainThread]: On master: COMMIT
[0m14:53:48.083393 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:53:48.085063 [debug] [MainThread]: On master: Close
[0m14:53:48.087149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:48.088682 [debug] [MainThread]: Connection 'model.dbt_project.mart_top_coins' was properly closed.
[0m14:53:48.090151 [info ] [MainThread]: 
[0m14:53:48.091647 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m14:53:48.099993 [debug] [MainThread]: Command end result
[0m14:53:48.187689 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m14:53:48.192877 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m14:53:48.207320 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m14:53:48.208062 [info ] [MainThread]: 
[0m14:53:48.208859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:48.209680 [info ] [MainThread]: 
[0m14:53:48.210541 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:53:48.215201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.878694, "process_in_blocks": "0", "process_kernel_time": 0.511841, "process_mem_max_rss": "115318784", "process_out_blocks": "0", "process_user_time": 5.261848}
[0m14:53:48.219189 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:48.218897 after 3.88 seconds
[0m14:53:48.221945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110531ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125152e0>]}
[0m14:53:48.223853 [debug] [MainThread]: Flushing usage events
[0m14:53:48.707219 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:14.804496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf66790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2a9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2a97f0>]}


============================== 22:52:14.816310 | 6ba255d9-fe3f-48df-8cef-0a3700e0e7c0 ==============================
[0m22:52:14.816310 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:52:14.817818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:52:15.187205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ba255d9-fe3f-48df-8cef-0a3700e0e7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e69b340>]}
[0m22:52:15.277316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ba255d9-fe3f-48df-8cef-0a3700e0e7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e695bb0>]}
[0m22:52:15.279229 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:52:15.503905 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:52:15.661688 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:52:15.662475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ba255d9-fe3f-48df-8cef-0a3700e0e7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f1130>]}
[0m22:52:17.425469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ba255d9-fe3f-48df-8cef-0a3700e0e7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2e2130>]}
[0m22:52:17.501088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ba255d9-fe3f-48df-8cef-0a3700e0e7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f331130>]}
[0m22:52:17.502436 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m22:52:17.503333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ba255d9-fe3f-48df-8cef-0a3700e0e7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f31af70>]}
[0m22:52:17.506591 [info ] [MainThread]: 
[0m22:52:17.507711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:52:17.508539 [info ] [MainThread]: 
[0m22:52:17.509764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:52:17.519766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m22:52:17.643206 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:52:17.643994 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m22:52:17.644554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:17.724620 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m22:52:17.725465 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m22:52:17.726173 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:52:17.748268 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.021 seconds
[0m22:52:17.750783 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m22:52:17.751777 [debug] [ThreadPool]: On list_postgres_public: Close
[0m22:52:17.753155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public, now list_postgres_public_staging)
[0m22:52:17.758156 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m22:52:17.758956 [debug] [ThreadPool]: On list_postgres_public_staging: BEGIN
[0m22:52:17.759570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:52:17.767287 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:52:17.768077 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_staging"
[0m22:52:17.768762 [debug] [ThreadPool]: On list_postgres_public_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_postgres_public_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m22:52:17.774405 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m22:52:17.777520 [debug] [ThreadPool]: On list_postgres_public_staging: ROLLBACK
[0m22:52:17.778550 [debug] [ThreadPool]: On list_postgres_public_staging: Close
[0m22:52:17.786824 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:17.787576 [debug] [MainThread]: On master: BEGIN
[0m22:52:17.788162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:52:17.795371 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m22:52:17.796116 [debug] [MainThread]: Using postgres connection "master"
[0m22:52:17.796829 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:52:17.810584 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m22:52:17.812951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ba255d9-fe3f-48df-8cef-0a3700e0e7c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3311f0>]}
[0m22:52:17.813908 [debug] [MainThread]: On master: ROLLBACK
[0m22:52:17.814790 [debug] [MainThread]: On master: Close
[0m22:52:17.819803 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_crypto_prices
[0m22:52:17.820867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_staging, now model.dbt_project.stg_crypto_prices)
[0m22:52:17.821659 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_crypto_prices
[0m22:52:17.836260 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_crypto_prices"
[0m22:52:17.839945 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_crypto_prices
[0m22:52:17.841811 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_crypto_prices
[0m22:52:17.843118 [debug] [Thread-1  ]: Began running node model.dbt_project.int_crypto_metrics
[0m22:52:17.843953 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.stg_crypto_prices, now model.dbt_project.int_crypto_metrics)
[0m22:52:17.844711 [debug] [Thread-1  ]: Began compiling node model.dbt_project.int_crypto_metrics
[0m22:52:17.850410 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.int_crypto_metrics"
[0m22:52:17.853802 [debug] [Thread-1  ]: Began executing node model.dbt_project.int_crypto_metrics
[0m22:52:17.855508 [debug] [Thread-1  ]: Finished running node model.dbt_project.int_crypto_metrics
[0m22:52:17.856781 [debug] [Thread-1  ]: Began running node model.dbt_project.mart_top_coins
[0m22:52:17.857723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_project.int_crypto_metrics, now model.dbt_project.mart_top_coins)
[0m22:52:17.858593 [debug] [Thread-1  ]: Began compiling node model.dbt_project.mart_top_coins
[0m22:52:17.864319 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.mart_top_coins"
[0m22:52:17.867874 [debug] [Thread-1  ]: Began executing node model.dbt_project.mart_top_coins
[0m22:52:17.869532 [debug] [Thread-1  ]: Finished running node model.dbt_project.mart_top_coins
[0m22:52:17.871128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:17.872031 [debug] [MainThread]: Connection 'model.dbt_project.mart_top_coins' was properly closed.
[0m22:52:17.873867 [debug] [MainThread]: Command end result
[0m22:52:17.991973 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m22:52:17.998480 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m22:52:18.009981 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vaida/Playground/crypto_dbt_project/target/run_results.json
[0m22:52:18.019736 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:52:18.020364 [info ] [MainThread]: Building catalog
[0m22:52:18.043474 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres.information_schema'
[0m22:52:18.060471 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m22:52:18.061211 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
[0m22:52:18.061798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:18.068673 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m22:52:18.069350 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m22:52:18.070029 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_coins')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_crypto_metrics')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_crypto_prices')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_crypto_prices')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:52:18.120365 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.049 seconds
[0m22:52:18.125169 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
[0m22:52:18.126371 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m22:52:18.137717 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/vaida/Playground/crypto_dbt_project/target/catalog.json
[0m22:52:18.178845 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vaida/Playground/crypto_dbt_project/target/manifest.json
[0m22:52:18.181518 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vaida/Playground/crypto_dbt_project/target/semantic_manifest.json
[0m22:52:18.182143 [info ] [MainThread]: Catalog written to /Users/vaida/Playground/crypto_dbt_project/target/catalog.json
[0m22:52:18.187198 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.5289395, "process_in_blocks": "0", "process_kernel_time": 0.881014, "process_mem_max_rss": "115105792", "process_out_blocks": "0", "process_user_time": 5.5646}
[0m22:52:18.188248 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:52:18.188045 after 3.53 seconds
[0m22:52:18.189219 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:52:18.189838 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.
[0m22:52:18.190522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf66790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e695bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e69b340>]}
[0m22:52:18.191319 [debug] [MainThread]: Flushing usage events
[0m22:52:18.754001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:23.571901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114f1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114f17c0>]}


============================== 22:52:23.580210 | ce693a6f-fd0f-4901-ab58-f43372a9849c ==============================
[0m22:52:23.580210 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:52:23.581503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/vaida/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/vaida/Playground/crypto_dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:52:23.833054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce693a6f-fd0f-4901-ab58-f43372a9849c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114e4340>]}
[0m22:52:23.915710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce693a6f-fd0f-4901-ab58-f43372a9849c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ee1f0>]}
[0m22:55:23.843758 [error] [MainThread]: Encountered an error:

[0m22:55:24.001790 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/Users/vaida/Playground/crypto_dbt_project/venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/http/server.py", line 660, in __init__
    super().__init__(*args, **kwargs)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 747, in __init__
    self.handle()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/http/server.py", line 434, in handle
    self.handle_one_request()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/http/server.py", line 402, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socket.py", line 704, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m22:55:24.050167 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 180.5897, "process_in_blocks": "0", "process_kernel_time": 0.587312, "process_mem_max_rss": "93409280", "process_out_blocks": "0", "process_user_time": 3.263447}
[0m22:55:24.059525 [debug] [MainThread]: Command `dbt docs serve` failed at 22:55:24.056063 after 180.60 seconds
[0m22:55:24.063793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b71e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b71f10>]}
[0m22:55:24.066469 [debug] [MainThread]: Flushing usage events
[0m22:55:24.609113 [debug] [MainThread]: An error was encountered while trying to flush usage events
